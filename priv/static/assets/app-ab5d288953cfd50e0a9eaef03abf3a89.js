(()=>{var Ut=Object.create;var Ee=Object.defineProperty;var Mt=Object.getOwnPropertyDescriptor;var Ft=Object.getOwnPropertyNames,it=Object.getOwnPropertySymbols,$t=Object.getPrototypeOf,nt=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable;var rt=(e,t,i)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,Te=(e,t)=>{for(var i in t||(t={}))nt.call(t,i)&&rt(e,i,t[i]);if(it)for(var i of it(t))Bt.call(t,i)&&rt(e,i,t[i]);return e};var Jt=e=>Ee(e,"__esModule",{value:!0});var Vt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Xt=(e,t,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ft(t))!nt.call(e,n)&&n!=="default"&&Ee(e,n,{get:()=>t[n],enumerable:!(i=Mt(t,n))||i.enumerable});return e},Wt=e=>Xt(Jt(Ee(e!=null?Ut($t(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var st=Vt((ve,Me)=>{(function(e,t){typeof ve=="object"&&typeof Me=="object"?Me.exports=t():typeof define=="function"&&define.amd?define([],t):typeof ve=="object"?ve.Phoenix=t():e.Phoenix=t()})(ve,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(n,r,a){i.o(n,r)||Object.defineProperty(n,r,{enumerable:!0,get:a})},i.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},i.t=function(n,r){if(1&r&&(n=i(n)),8&r||4&r&&typeof n=="object"&&n&&n.__esModule)return n;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:n}),2&r&&typeof n!="string")for(var h in n)i.d(a,h,function(d){return n[d]}.bind(null,h));return a},i.n=function(n){var r=n&&n.__esModule?function(){return n.default}:function(){return n};return i.d(r,"a",r),r},i.o=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)},i.p="",i(i.s=0)}([function(e,t,i){(function(n){e.exports=n.Phoenix=i(2)}).call(this,i(1))},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(n){typeof window=="object"&&(i=window)}e.exports=i},function(e,t,i){"use strict";function n(c){return function(s){if(Array.isArray(s))return d(s)}(c)||function(s){if(typeof Symbol!="undefined"&&Symbol.iterator in Object(s))return Array.from(s)}(c)||h(c)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function r(c){return(r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s})(c)}function a(c,s){return function(o){if(Array.isArray(o))return o}(c)||function(o,l){if(!(typeof Symbol=="undefined"||!(Symbol.iterator in Object(o)))){var u=[],y=!0,b=!1,m=void 0;try{for(var k,w=o[Symbol.iterator]();!(y=(k=w.next()).done)&&(u.push(k.value),!l||u.length!==l);y=!0);}catch(L){b=!0,m=L}finally{try{y||w.return==null||w.return()}finally{if(b)throw m}}return u}}(c,s)||h(c,s)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function h(c,s){if(c){if(typeof c=="string")return d(c,s);var o=Object.prototype.toString.call(c).slice(8,-1);return o==="Object"&&c.constructor&&(o=c.constructor.name),o==="Map"||o==="Set"?Array.from(o):o==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?d(c,s):void 0}}function d(c,s){(s==null||s>c.length)&&(s=c.length);for(var o=0,l=new Array(s);o<s;o++)l[o]=c[o];return l}function f(c,s){if(!(c instanceof s))throw new TypeError("Cannot call a class as a function")}function E(c,s){for(var o=0;o<s.length;o++){var l=s[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(c,l.key,l)}}function g(c,s,o){return s&&E(c.prototype,s),o&&E(c,o),c}i.r(t),i.d(t,"Channel",function(){return A}),i.d(t,"Serializer",function(){return P}),i.d(t,"Socket",function(){return F}),i.d(t,"LongPoll",function(){return B}),i.d(t,"Ajax",function(){return U}),i.d(t,"Presence",function(){return ue});var T=typeof self!="undefined"?self:null,R=typeof window!="undefined"?window:null,I=T||R||void 0,_=0,O=1,Q=2,v=3,D="closed",X="errored",Z="joined",ae="joining",Ce="leaving",ee="phx_close",fe="phx_error",H="phx_join",te="phx_reply",le="phx_leave",pe=[ee,fe,H,te,le],je="longpoll",he="websocket",C=function(c){return typeof c=="function"?c:function(){return c}},S=function(){function c(s,o,l,u){f(this,c),this.channel=s,this.event=o,this.payload=l||function(){return{}},this.receivedResp=null,this.timeout=u,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}return g(c,[{key:"resend",value:function(s){this.timeout=s,this.reset(),this.send()}},{key:"send",value:function(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}},{key:"receive",value:function(s,o){return this.hasReceived(s)&&o(this.receivedResp.response),this.recHooks.push({status:s,callback:o}),this}},{key:"reset",value:function(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}},{key:"matchReceive",value:function(s){var o=s.status,l=s.response;s.ref,this.recHooks.filter(function(u){return u.status===o}).forEach(function(u){return u.callback(l)})}},{key:"cancelRefEvent",value:function(){this.refEvent&&this.channel.off(this.refEvent)}},{key:"cancelTimeout",value:function(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}},{key:"startTimeout",value:function(){var s=this;this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,function(o){s.cancelRefEvent(),s.cancelTimeout(),s.receivedResp=o,s.matchReceive(o)}),this.timeoutTimer=setTimeout(function(){s.trigger("timeout",{})},this.timeout)}},{key:"hasReceived",value:function(s){return this.receivedResp&&this.receivedResp.status===s}},{key:"trigger",value:function(s,o){this.channel.trigger(this.refEvent,{status:s,response:o})}}]),c}(),A=function(){function c(s,o,l){var u=this;f(this,c),this.state=D,this.topic=s,this.params=C(o||{}),this.socket=l,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new S(this,H,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new V(function(){u.socket.isConnected()&&u.rejoin()},this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(function(){return u.rejoinTimer.reset()})),this.stateChangeRefs.push(this.socket.onOpen(function(){u.rejoinTimer.reset(),u.isErrored()&&u.rejoin()})),this.joinPush.receive("ok",function(){u.state=Z,u.rejoinTimer.reset(),u.pushBuffer.forEach(function(y){return y.send()}),u.pushBuffer=[]}),this.joinPush.receive("error",function(){u.state=X,u.socket.isConnected()&&u.rejoinTimer.scheduleTimeout()}),this.onClose(function(){u.rejoinTimer.reset(),u.socket.hasLogger()&&u.socket.log("channel","close ".concat(u.topic," ").concat(u.joinRef())),u.state=D,u.socket.remove(u)}),this.onError(function(y){u.socket.hasLogger()&&u.socket.log("channel","error ".concat(u.topic),y),u.isJoining()&&u.joinPush.reset(),u.state=X,u.socket.isConnected()&&u.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",function(){u.socket.hasLogger()&&u.socket.log("channel","timeout ".concat(u.topic," (").concat(u.joinRef(),")"),u.joinPush.timeout),new S(u,le,C({}),u.timeout).send(),u.state=X,u.joinPush.reset(),u.socket.isConnected()&&u.rejoinTimer.scheduleTimeout()}),this.on(te,function(y,b){u.trigger(u.replyEventName(b),y)})}return g(c,[{key:"join",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.timeout;if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=s,this.joinedOnce=!0,this.rejoin(),this.joinPush}},{key:"onClose",value:function(s){this.on(ee,s)}},{key:"onError",value:function(s){return this.on(fe,function(o){return s(o)})}},{key:"on",value:function(s,o){var l=this.bindingRef++;return this.bindings.push({event:s,ref:l,callback:o}),l}},{key:"off",value:function(s,o){this.bindings=this.bindings.filter(function(l){return!(l.event===s&&(o===void 0||o===l.ref))})}},{key:"canPush",value:function(){return this.socket.isConnected()&&this.isJoined()}},{key:"push",value:function(s,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.timeout;if(o=o||{},!this.joinedOnce)throw new Error("tried to push '".concat(s,"' to '").concat(this.topic,"' before joining. Use channel.join() before pushing events"));var u=new S(this,s,function(){return o},l);return this.canPush()?u.send():(u.startTimeout(),this.pushBuffer.push(u)),u}},{key:"leave",value:function(){var s=this,o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.timeout;this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=Ce;var l=function(){s.socket.hasLogger()&&s.socket.log("channel","leave ".concat(s.topic)),s.trigger(ee,"leave")},u=new S(this,le,C({}),o);return u.receive("ok",function(){return l()}).receive("timeout",function(){return l()}),u.send(),this.canPush()||u.trigger("ok",{}),u}},{key:"onMessage",value:function(s,o,l){return o}},{key:"isLifecycleEvent",value:function(s){return pe.indexOf(s)>=0}},{key:"isMember",value:function(s,o,l,u){return this.topic===s&&(!u||u===this.joinRef()||!this.isLifecycleEvent(o)||(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:s,event:o,payload:l,joinRef:u}),!1))}},{key:"joinRef",value:function(){return this.joinPush.ref}},{key:"rejoin",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.timeout;this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=ae,this.joinPush.resend(s))}},{key:"trigger",value:function(s,o,l,u){var y=this.onMessage(s,o,l,u);if(o&&!y)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");for(var b=this.bindings.filter(function(k){return k.event===s}),m=0;m<b.length;m++)b[m].callback(y,l,u||this.joinRef())}},{key:"replyEventName",value:function(s){return"chan_reply_".concat(s)}},{key:"isClosed",value:function(){return this.state===D}},{key:"isErrored",value:function(){return this.state===X}},{key:"isJoined",value:function(){return this.state===Z}},{key:"isJoining",value:function(){return this.state===ae}},{key:"isLeaving",value:function(){return this.state===Ce}}]),c}(),P={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode:function(c,s){if(c.payload.constructor===ArrayBuffer)return s(this.binaryEncode(c));var o=[c.join_ref,c.ref,c.topic,c.event,c.payload];return s(JSON.stringify(o))},decode:function(c,s){if(c.constructor===ArrayBuffer)return s(this.binaryDecode(c));var o=a(JSON.parse(c),5);return s({join_ref:o[0],ref:o[1],topic:o[2],event:o[3],payload:o[4]})},binaryEncode:function(c){var s=c.join_ref,o=c.ref,l=c.event,u=c.topic,y=c.payload,b=this.META_LENGTH+s.length+o.length+u.length+l.length,m=new ArrayBuffer(this.HEADER_LENGTH+b),k=new DataView(m),w=0;k.setUint8(w++,this.KINDS.push),k.setUint8(w++,s.length),k.setUint8(w++,o.length),k.setUint8(w++,u.length),k.setUint8(w++,l.length),Array.from(s,function(x){return k.setUint8(w++,x.charCodeAt(0))}),Array.from(o,function(x){return k.setUint8(w++,x.charCodeAt(0))}),Array.from(u,function(x){return k.setUint8(w++,x.charCodeAt(0))}),Array.from(l,function(x){return k.setUint8(w++,x.charCodeAt(0))});var L=new Uint8Array(m.byteLength+y.byteLength);return L.set(new Uint8Array(m),0),L.set(new Uint8Array(y),m.byteLength),L.buffer},binaryDecode:function(c){var s=new DataView(c),o=s.getUint8(0),l=new TextDecoder;switch(o){case this.KINDS.push:return this.decodePush(c,s,l);case this.KINDS.reply:return this.decodeReply(c,s,l);case this.KINDS.broadcast:return this.decodeBroadcast(c,s,l)}},decodePush:function(c,s,o){var l=s.getUint8(1),u=s.getUint8(2),y=s.getUint8(3),b=this.HEADER_LENGTH+this.META_LENGTH-1,m=o.decode(c.slice(b,b+l));b+=l;var k=o.decode(c.slice(b,b+u));b+=u;var w=o.decode(c.slice(b,b+y));return b+=y,{join_ref:m,ref:null,topic:k,event:w,payload:c.slice(b,c.byteLength)}},decodeReply:function(c,s,o){var l=s.getUint8(1),u=s.getUint8(2),y=s.getUint8(3),b=s.getUint8(4),m=this.HEADER_LENGTH+this.META_LENGTH,k=o.decode(c.slice(m,m+l));m+=l;var w=o.decode(c.slice(m,m+u));m+=u;var L=o.decode(c.slice(m,m+y));m+=y;var x=o.decode(c.slice(m,m+b));m+=b;var G=c.slice(m,c.byteLength);return{join_ref:k,ref:w,topic:L,event:te,payload:{status:x,response:G}}},decodeBroadcast:function(c,s,o){var l=s.getUint8(1),u=s.getUint8(2),y=this.HEADER_LENGTH+2,b=o.decode(c.slice(y,y+l));y+=l;var m=o.decode(c.slice(y,y+u));return y+=u,{join_ref:null,ref:null,topic:b,event:m,payload:c.slice(y,c.byteLength)}}},F=function(){function c(s){var o=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f(this,c),this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=l.timeout||1e4,this.transport=l.transport||I.WebSocket||B,this.defaultEncoder=P.encode.bind(P),this.defaultDecoder=P.decode.bind(P),this.closeWasClean=!1,this.unloaded=!1,this.binaryType=l.binaryType||"arraybuffer",this.transport!==B?(this.encode=l.encode||this.defaultEncoder,this.decode=l.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder),R&&R.addEventListener&&R.addEventListener("beforeunload",function(u){o.conn&&(o.unloaded=!0,o.abnormalClose("unloaded"))}),this.heartbeatIntervalMs=l.heartbeatIntervalMs||3e4,this.rejoinAfterMs=function(u){return l.rejoinAfterMs?l.rejoinAfterMs(u):[1e3,2e3,5e3][u-1]||1e4},this.reconnectAfterMs=function(u){return o.unloaded?100:l.reconnectAfterMs?l.reconnectAfterMs(u):[10,50,100,150,200,250,500,1e3,2e3][u-1]||5e3},this.logger=l.logger||null,this.longpollerTimeout=l.longpollerTimeout||2e4,this.params=C(l.params||{}),this.endPoint="".concat(s,"/").concat(he),this.vsn=l.vsn||"2.0.0",this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new V(function(){o.teardown(function(){return o.connect()})},this.reconnectAfterMs)}return g(c,[{key:"protocol",value:function(){return location.protocol.match(/^https/)?"wss":"ws"}},{key:"endPointURL",value:function(){var s=U.appendParams(U.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return s.charAt(0)!=="/"?s:s.charAt(1)==="/"?"".concat(this.protocol(),":").concat(s):"".concat(this.protocol(),"://").concat(location.host).concat(s)}},{key:"disconnect",value:function(s,o,l){this.closeWasClean=!0,this.reconnectTimer.reset(),this.teardown(s,o,l)}},{key:"connect",value:function(s){var o=this;s&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=C(s)),this.conn||(this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=function(){return o.onConnOpen()},this.conn.onerror=function(l){return o.onConnError(l)},this.conn.onmessage=function(l){return o.onConnMessage(l)},this.conn.onclose=function(l){return o.onConnClose(l)})}},{key:"log",value:function(s,o,l){this.logger(s,o,l)}},{key:"hasLogger",value:function(){return this.logger!==null}},{key:"onOpen",value:function(s){var o=this.makeRef();return this.stateChangeCallbacks.open.push([o,s]),o}},{key:"onClose",value:function(s){var o=this.makeRef();return this.stateChangeCallbacks.close.push([o,s]),o}},{key:"onError",value:function(s){var o=this.makeRef();return this.stateChangeCallbacks.error.push([o,s]),o}},{key:"onMessage",value:function(s){var o=this.makeRef();return this.stateChangeCallbacks.message.push([o,s]),o}},{key:"onConnOpen",value:function(){this.hasLogger()&&this.log("transport","connected to ".concat(this.endPointURL())),this.unloaded=!1,this.closeWasClean=!1,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(function(s){return(0,a(s,2)[1])()})}},{key:"heartbeatTimeout",value:function(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.abnormalClose("heartbeat timeout"))}},{key:"resetHeartbeat",value:function(){var s=this;this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,clearTimeout(this.heartbeatTimer),setTimeout(function(){return s.sendHeartbeat()},this.heartbeatIntervalMs))}},{key:"teardown",value:function(s,o,l){var u=this;if(!this.conn)return s&&s();this.waitForBufferDone(function(){u.conn&&(o?u.conn.close(o,l||""):u.conn.close()),u.waitForSocketClosed(function(){u.conn&&(u.conn.onclose=function(){},u.conn=null),s&&s()})})}},{key:"waitForBufferDone",value:function(s){var o=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;l!==5&&this.conn&&this.conn.bufferedAmount?setTimeout(function(){o.waitForBufferDone(s,l+1)},150*l):s()}},{key:"waitForSocketClosed",value:function(s){var o=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;l!==5&&this.conn&&this.conn.readyState!==v?setTimeout(function(){o.waitForSocketClosed(s,l+1)},150*l):s()}},{key:"onConnClose",value:function(s){this.hasLogger()&&this.log("transport","close",s),this.triggerChanError(),clearTimeout(this.heartbeatTimer),this.closeWasClean||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(function(o){return(0,a(o,2)[1])(s)})}},{key:"onConnError",value:function(s){this.hasLogger()&&this.log("transport",s),this.triggerChanError(),this.stateChangeCallbacks.error.forEach(function(o){return(0,a(o,2)[1])(s)})}},{key:"triggerChanError",value:function(){this.channels.forEach(function(s){s.isErrored()||s.isLeaving()||s.isClosed()||s.trigger(fe)})}},{key:"connectionState",value:function(){switch(this.conn&&this.conn.readyState){case _:return"connecting";case O:return"open";case Q:return"closing";default:return"closed"}}},{key:"isConnected",value:function(){return this.connectionState()==="open"}},{key:"remove",value:function(s){this.off(s.stateChangeRefs),this.channels=this.channels.filter(function(o){return o.joinRef()!==s.joinRef()})}},{key:"off",value:function(s){for(var o in this.stateChangeCallbacks)this.stateChangeCallbacks[o]=this.stateChangeCallbacks[o].filter(function(l){var u=a(l,1)[0];return s.indexOf(u)===-1})}},{key:"channel",value:function(s){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=new A(s,o,this);return this.channels.push(l),l}},{key:"push",value:function(s){var o=this;if(this.hasLogger()){var l=s.topic,u=s.event,y=s.payload,b=s.ref,m=s.join_ref;this.log("push","".concat(l," ").concat(u," (").concat(m,", ").concat(b,")"),y)}this.isConnected()?this.encode(s,function(k){return o.conn.send(k)}):this.sendBuffer.push(function(){return o.encode(s,function(k){return o.conn.send(k)})})}},{key:"makeRef",value:function(){var s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}},{key:"sendHeartbeat",value:function(){var s=this;this.pendingHeartbeatRef&&!this.isConnected()||(this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatTimer=setTimeout(function(){return s.heartbeatTimeout()},this.heartbeatIntervalMs))}},{key:"abnormalClose",value:function(s){this.closeWasClean=!1,this.isConnected()&&this.conn.close(1e3,s)}},{key:"flushSendBuffer",value:function(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(function(s){return s()}),this.sendBuffer=[])}},{key:"onConnMessage",value:function(s){var o=this;this.decode(s.data,function(l){var u=l.topic,y=l.event,b=l.payload,m=l.ref,k=l.join_ref;m&&m===o.pendingHeartbeatRef&&(clearTimeout(o.heartbeatTimer),o.pendingHeartbeatRef=null,setTimeout(function(){return o.sendHeartbeat()},o.heartbeatIntervalMs)),o.hasLogger()&&o.log("receive","".concat(b.status||""," ").concat(u," ").concat(y," ").concat(m&&"("+m+")"||""),b);for(var w=0;w<o.channels.length;w++){var L=o.channels[w];L.isMember(u,y,b,k)&&L.trigger(y,b,m,k)}for(var x=0;x<o.stateChangeCallbacks.message.length;x++)(0,a(o.stateChangeCallbacks.message[x],2)[1])(l)})}},{key:"leaveOpenTopic",value:function(s){var o=this.channels.find(function(l){return l.topic===s&&(l.isJoined()||l.isJoining())});o&&(this.hasLogger()&&this.log("transport",'leaving duplicate topic "'.concat(s,'"')),o.leave())}}]),c}(),B=function(){function c(s){f(this,c),this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(s),this.readyState=_,this.poll()}return g(c,[{key:"normalizeEndpoint",value:function(s){return s.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+he),"$1/"+je)}},{key:"endpointURL",value:function(){return U.appendParams(this.pollEndpoint,{token:this.token})}},{key:"closeAndRetry",value:function(){this.close(),this.readyState=_}},{key:"ontimeout",value:function(){this.onerror("timeout"),this.closeAndRetry()}},{key:"poll",value:function(){var s=this;this.readyState!==O&&this.readyState!==_||U.request("GET",this.endpointURL(),"application/json",null,this.timeout,this.ontimeout.bind(this),function(o){if(o){var l=o.status,u=o.token,y=o.messages;s.token=u}else l=0;switch(l){case 200:y.forEach(function(b){setTimeout(function(){s.onmessage({data:b})},0)}),s.poll();break;case 204:s.poll();break;case 410:s.readyState=O,s.onopen(),s.poll();break;case 403:s.onerror(),s.close();break;case 0:case 500:s.onerror(),s.closeAndRetry();break;default:throw new Error("unhandled poll status ".concat(l))}})}},{key:"send",value:function(s){var o=this;U.request("POST",this.endpointURL(),"application/json",s,this.timeout,this.onerror.bind(this,"timeout"),function(l){l&&l.status===200||(o.onerror(l&&l.status),o.closeAndRetry())})}},{key:"close",value:function(s,o){this.readyState=v,this.onclose()}}]),c}(),U=function(){function c(){f(this,c)}return g(c,null,[{key:"request",value:function(s,o,l,u,y,b,m){if(I.XDomainRequest){var k=new XDomainRequest;this.xdomainRequest(k,s,o,u,y,b,m)}else{var w=new I.XMLHttpRequest;this.xhrRequest(w,s,o,l,u,y,b,m)}}},{key:"xdomainRequest",value:function(s,o,l,u,y,b,m){var k=this;s.timeout=y,s.open(o,l),s.onload=function(){var w=k.parseJSON(s.responseText);m&&m(w)},b&&(s.ontimeout=b),s.onprogress=function(){},s.send(u)}},{key:"xhrRequest",value:function(s,o,l,u,y,b,m,k){var w=this;s.open(o,l,!0),s.timeout=b,s.setRequestHeader("Content-Type",u),s.onerror=function(){k&&k(null)},s.onreadystatechange=function(){if(s.readyState===w.states.complete&&k){var L=w.parseJSON(s.responseText);k(L)}},m&&(s.ontimeout=m),s.send(y)}},{key:"parseJSON",value:function(s){if(!s||s==="")return null;try{return JSON.parse(s)}catch(o){return console&&console.log("failed to parse JSON response",s),null}}},{key:"serialize",value:function(s,o){var l=[];for(var u in s)if(s.hasOwnProperty(u)){var y=o?"".concat(o,"[").concat(u,"]"):u,b=s[u];r(b)==="object"?l.push(this.serialize(b,y)):l.push(encodeURIComponent(y)+"="+encodeURIComponent(b))}return l.join("&")}},{key:"appendParams",value:function(s,o){if(Object.keys(o).length===0)return s;var l=s.match(/\?/)?"&":"?";return"".concat(s).concat(l).concat(this.serialize(o))}}]),c}();U.states={complete:4};var ue=function(){function c(s){var o=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f(this,c);var u=l.events||{state:"presence_state",diff:"presence_diff"};this.state={},this.pendingDiffs=[],this.channel=s,this.joinRef=null,this.caller={onJoin:function(){},onLeave:function(){},onSync:function(){}},this.channel.on(u.state,function(y){var b=o.caller,m=b.onJoin,k=b.onLeave,w=b.onSync;o.joinRef=o.channel.joinRef(),o.state=c.syncState(o.state,y,m,k),o.pendingDiffs.forEach(function(L){o.state=c.syncDiff(o.state,L,m,k)}),o.pendingDiffs=[],w()}),this.channel.on(u.diff,function(y){var b=o.caller,m=b.onJoin,k=b.onLeave,w=b.onSync;o.inPendingSyncState()?o.pendingDiffs.push(y):(o.state=c.syncDiff(o.state,y,m,k),w())})}return g(c,[{key:"onJoin",value:function(s){this.caller.onJoin=s}},{key:"onLeave",value:function(s){this.caller.onLeave=s}},{key:"onSync",value:function(s){this.caller.onSync=s}},{key:"list",value:function(s){return c.list(this.state,s)}},{key:"inPendingSyncState",value:function(){return!this.joinRef||this.joinRef!==this.channel.joinRef()}}],[{key:"syncState",value:function(s,o,l,u){var y=this,b=this.clone(s),m={},k={};return this.map(b,function(w,L){o[w]||(k[w]=L)}),this.map(o,function(w,L){var x=b[w];if(x){var G=L.metas.map(function(re){return re.phx_ref}),Ue=x.metas.map(function(re){return re.phx_ref}),ce=L.metas.filter(function(re){return Ue.indexOf(re.phx_ref)<0}),tt=x.metas.filter(function(re){return G.indexOf(re.phx_ref)<0});ce.length>0&&(m[w]=L,m[w].metas=ce),tt.length>0&&(k[w]=y.clone(x),k[w].metas=tt)}else m[w]=L}),this.syncDiff(b,{joins:m,leaves:k},l,u)}},{key:"syncDiff",value:function(s,o,l,u){var y=o.joins,b=o.leaves,m=this.clone(s);return l||(l=function(){}),u||(u=function(){}),this.map(y,function(k,w){var L=m[k];if(m[k]=w,L){var x,G=m[k].metas.map(function(ce){return ce.phx_ref}),Ue=L.metas.filter(function(ce){return G.indexOf(ce.phx_ref)<0});(x=m[k].metas).unshift.apply(x,n(Ue))}l(k,L,w)}),this.map(b,function(k,w){var L=m[k];if(L){var x=w.metas.map(function(G){return G.phx_ref});L.metas=L.metas.filter(function(G){return x.indexOf(G.phx_ref)<0}),u(k,L,w),L.metas.length===0&&delete m[k]}}),m}},{key:"list",value:function(s,o){return o||(o=function(l,u){return u}),this.map(s,function(l,u){return o(l,u)})}},{key:"map",value:function(s,o){return Object.getOwnPropertyNames(s).map(function(l){return o(l,s[l])})}},{key:"clone",value:function(s){return JSON.parse(JSON.stringify(s))}}]),c}(),V=function(){function c(s,o){f(this,c),this.callback=s,this.timerCalc=o,this.timer=null,this.tries=0}return g(c,[{key:"reset",value:function(){this.tries=0,clearTimeout(this.timer)}},{key:"scheduleTimeout",value:function(){var s=this;clearTimeout(this.timer),this.timer=setTimeout(function(){s.tries=s.tries+1,s.callback()},this.timerCalc(this.tries+1))}}]),c}()}])})});var jt=Wt(st());var ot="consecutive-reloads",at=10,Kt=[1e3,3e3],qt=3e4,lt=["phx-click-loading","phx-change-loading","phx-submit-loading","phx-keydown-loading","phx-keyup-loading","phx-blur-loading","phx-focus-loading"],J="data-phx-component",Fe="data-phx-link",Gt="track-static",zt="data-phx-link-state",W="data-phx-ref",ht="track-uploads",se="data-phx-upload-ref",$e="data-phx-preflighted-refs",Yt="data-phx-done-refs",ut="drop-target",Be="data-phx-active-refs",Je="phx:live-file:updated",Ve="data-phx-skip",ct="data-phx-remove",dt="page-loading",ft="phx-connected",_e="phx-disconnected",pt="phx-no-feedback",vt="phx-error",ge="data-phx-parent-id",gt="data-phx-main",Pe="data-phx-root-id",Qt="trigger-action",mt="feedback-for",bt="phx-has-focused",Zt=["text","textarea","number","email","password","search","tel","url","date","time"],yt=["checkbox","radio"],kt="phx-has-submitted",ie="data-phx-session",de=`[${ie}]`,me="data-phx-static",Xe="data-phx-readonly",Le="data-phx-disabled",We="disable-with",Re="data-phx-disable-with-restore",Ie="hook",ei="debounce",ti="throttle",Ke="update",ii="key",K="phxPrivate",wt="auto-recover",qe="phx:live-socket:debug",Ge="phx:live-socket:profiling",ze="phx:live-socket:latency-sim",ni="progress",ri=1,si=200,oi="phx-",ai=3e4,be="debounce-trigger",De="throttled",At="debounce-prev-key",li={debounce:300,throttle:300},St="d",q="s",$="c",Ct="e",Et="r",Tt="t",hi=class{constructor(e,t,i){this.liveSocket=i,this.entry=e,this.offset=0,this.chunkSize=t,this.chunkTimer=null,this.uploadChannel=i.channel(`lvu:${e.ref}`,{token:e.metadata()})}error(e){clearTimeout(this.chunkTimer),this.uploadChannel.leave(),this.entry.error(e)}upload(){this.uploadChannel.onError(e=>this.error(e)),this.uploadChannel.join().receive("ok",e=>this.readNextChunk()).receive("error",e=>this.error(e))}isDone(){return this.offset>=this.entry.file.size}readNextChunk(){let e=new window.FileReader,t=this.entry.file.slice(this.offset,this.chunkSize+this.offset);e.onload=i=>{if(i.target.error===null)this.offset+=i.target.result.byteLength,this.pushChunk(i.target.result);else return N("Read error: "+i.target.error)},e.readAsArrayBuffer(t)}pushChunk(e){!this.uploadChannel.isJoined()||this.uploadChannel.push("chunk",e).receive("ok",()=>{this.entry.progress(this.offset/this.entry.file.size*100),this.isDone()||(this.chunkTimer=setTimeout(()=>this.readNextChunk(),this.liveSocket.getLatencySim()||0))})}},N=(e,t)=>console.error&&console.error(e,t),xe=e=>typeof e=="number";function ui(){let e=new Set,t=document.querySelectorAll("*[id]");for(let i=0,n=t.length;i<n;i++)e.has(t[i].id)?console.error(`Multiple IDs detected: ${t[i].id}. Ensure unique element ids.`):e.add(t[i].id)}var ci=(e,t,i,n)=>{e.liveSocket.isDebugEnabled()&&console.log(`${e.id} ${t}: ${i} - `,n)},Ye=e=>typeof e=="function"?e:function(){return e},ye=e=>JSON.parse(JSON.stringify(e)),ke=(e,t,i)=>{do{if(e.matches(`[${t}]`))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===1&&!(i&&i.isSameNode(e)||e.matches(de)));return null},we=e=>e!==null&&typeof e=="object"&&!(e instanceof Array),di=(e,t)=>JSON.stringify(e)===JSON.stringify(t),_t=e=>{for(let t in e)return!1;return!0},z=(e,t)=>e&&t(e),fi=function(e,t,i,n){e.forEach(r=>{new hi(r,i.config.chunk_size,n).upload()})},Pt={canPushState(){return typeof history.pushState!="undefined"},dropLocal(e,t,i){return e.removeItem(this.localKey(t,i))},updateLocal(e,t,i,n,r){let a=this.getLocal(e,t,i),h=this.localKey(t,i),d=a===null?n:r(a);return e.setItem(h,JSON.stringify(d)),d},getLocal(e,t,i){return JSON.parse(e.getItem(this.localKey(t,i)))},updateCurrentState(e){!this.canPushState()||history.replaceState(e(history.state||{}),"",window.location.href)},pushState(e,t,i){if(this.canPushState()){if(i!==window.location.href){if(t.type=="redirect"&&t.scroll){let r=history.state||{};r.scroll=t.scroll,history.replaceState(r,"",window.location.href)}delete t.scroll,history[e+"State"](t,"",i||null);let n=this.getHashTargetEl(window.location.hash);n?n.scrollIntoView():t.type==="redirect"&&window.scroll(0,0)}}else this.redirect(i)},setCookie(e,t){document.cookie=`${e}=${t}`},getCookie(e){return document.cookie.replace(new RegExp(`(?:(?:^|.*;s*)${e}s*=s*([^;]*).*$)|^.*$`),"$1")},redirect(e,t){t&&Pt.setCookie("__phoenix_flash__",t+"; max-age=60000; path=/"),window.location=e},localKey(e,t){return`${e}-${t}`},getHashTargetEl(e){let t=e.toString().substring(1);if(t!=="")return document.getElementById(t)||document.querySelector(`a[name="${t}"]`)}},ne=Pt,Y={byId(e){return document.getElementById(e)||N(`no id found for ${e}`)},removeClass(e,t){e.classList.remove(t),e.classList.length===0&&e.removeAttribute("class")},all(e,t,i){if(!e)return[];let n=Array.from(e.querySelectorAll(t));return i?n.forEach(i):n},childNodeLength(e){let t=document.createElement("template");return t.innerHTML=e,t.content.childElementCount},isUploadInput(e){return e.type==="file"&&e.getAttribute(se)!==null},findUploadInputs(e){return this.all(e,`input[type="file"][${se}]`)},findComponentNodeList(e,t){return this.filterWithinSameLiveView(this.all(e,`[${J}="${t}"]`),e)},isPhxDestroyed(e){return!!(e.id&&Y.private(e,"destroyed"))},markPhxChildDestroyed(e){e.setAttribute(ie,""),this.putPrivate(e,"destroyed",!0)},findPhxChildrenInFragment(e,t){let i=document.createElement("template");return i.innerHTML=e,this.findPhxChildren(i.content,t)},isIgnored(e,t){return(e.getAttribute(t)||e.getAttribute("data-phx-update"))==="ignore"},isPhxUpdate(e,t,i){return e.getAttribute&&i.indexOf(e.getAttribute(t))>=0},findPhxChildren(e,t){return this.all(e,`${de}[${ge}="${t}"]`)},findParentCIDs(e,t){let i=new Set(t);return t.reduce((n,r)=>{let a=`[${J}="${r}"] [${J}]`;return this.filterWithinSameLiveView(this.all(e,a),e).map(h=>parseInt(h.getAttribute(J))).forEach(h=>n.delete(h)),n},i)},filterWithinSameLiveView(e,t){return t.querySelector(de)?e.filter(i=>this.withinSameLiveView(i,t)):e},withinSameLiveView(e,t){for(;e=e.parentNode;){if(e.isSameNode(t))return!0;if(e.getAttribute(ie)!==null)return!1}},private(e,t){return e[K]&&e[K][t]},deletePrivate(e,t){e[K]&&delete e[K][t]},putPrivate(e,t,i){e[K]||(e[K]={}),e[K][t]=i},copyPrivates(e,t){t[K]&&(e[K]=ye(t[K]))},putTitle(e){let t=document.querySelector("title"),{prefix:i,suffix:n}=t.dataset;document.title=`${i||""}${e}${n||""}`},debounce(e,t,i,n,r,a,h){let d=e.getAttribute(i),f=e.getAttribute(r);d===""&&(d=n),f===""&&(f=a);let E=d||f;switch(E){case null:return h();case"blur":this.once(e,"debounce-blur")&&e.addEventListener("blur",()=>h());return;default:let g=parseInt(E),T=()=>f?this.deletePrivate(e,De):h(),R=this.incCycle(e,be,T);if(isNaN(g))return N(`invalid throttle/debounce value: ${E}`);if(f){let _=!1;if(t.type==="keydown"){let O=this.private(e,At);this.putPrivate(e,At,t.key),_=O!==t.key}if(!_&&this.private(e,De))return!1;h(),this.putPrivate(e,De,!0),setTimeout(()=>this.triggerCycle(e,be),g)}else setTimeout(()=>this.triggerCycle(e,be,R),g);let I=e.form;I&&this.once(I,"bind-debounce")&&I.addEventListener("submit",()=>{Array.from(new FormData(I).entries(),([_])=>{let O=I.querySelector(`[name="${_}"]`);this.incCycle(O,be),this.deletePrivate(O,De)})}),this.once(e,"bind-debounce")&&e.addEventListener("blur",()=>this.triggerCycle(e,be))}},triggerCycle(e,t,i){let[n,r]=this.private(e,t);i||(i=n),i===n&&(this.incCycle(e,t),r())},once(e,t){return this.private(e,t)===!0?!1:(this.putPrivate(e,t,!0),!0)},incCycle(e,t,i=function(){}){let[n]=this.private(e,t)||[0,i];return n++,this.putPrivate(e,t,[n,i]),n},discardError(e,t,i){let n=t.getAttribute&&t.getAttribute(i),r=n&&e.querySelector(`[id="${n}"], [name="${n}"]`);!r||this.private(r,bt)||this.private(r.form,kt)||t.classList.add(pt)},showError(e,t){(e.id||e.name)&&this.all(e.form,`[${t}="${e.id}"], [${t}="${e.name}"]`,i=>{this.removeClass(i,pt)})},isPhxChild(e){return e.getAttribute&&e.getAttribute(ge)},dispatchEvent(e,t,i={}){let n=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:i});e.dispatchEvent(n)},cloneNode(e,t){if(typeof t=="undefined")return e.cloneNode(!0);{let i=e.cloneNode(!1);return i.innerHTML=t,i}},mergeAttrs(e,t,i={}){let n=i.exclude||[],r=i.isIgnored,a=t.attributes;for(let d=a.length-1;d>=0;d--){let f=a[d].name;n.indexOf(f)<0&&e.setAttribute(f,t.getAttribute(f))}let h=e.attributes;for(let d=h.length-1;d>=0;d--){let f=h[d].name;r?f.startsWith("data-")&&!t.hasAttribute(f)&&e.removeAttribute(f):t.hasAttribute(f)||e.removeAttribute(f)}},mergeFocusedInput(e,t){e instanceof HTMLSelectElement||Y.mergeAttrs(e,t,{except:["value"]}),t.readOnly?e.setAttribute("readonly",!0):e.removeAttribute("readonly")},hasSelectionRange(e){return e.setSelectionRange&&(e.type==="text"||e.type==="textarea")},restoreFocus(e,t,i){if(!Y.isTextualInput(e))return;let n=e.matches(":focus");e.readOnly&&e.blur(),n||e.focus(),this.hasSelectionRange(e)&&e.setSelectionRange(t,i)},isFormInput(e){return/^(?:input|select|textarea)$/i.test(e.tagName)&&e.type!=="button"},syncAttrsToProps(e){e instanceof HTMLInputElement&&yt.indexOf(e.type.toLocaleLowerCase())>=0&&(e.checked=e.getAttribute("checked")!==null)},syncPropsToAttrs(e){if(e instanceof HTMLSelectElement){let t=e.options.item(e.selectedIndex);t&&t.getAttribute("selected")===null&&t.setAttribute("selected","")}},isTextualInput(e){return Zt.indexOf(e.type)>=0},isNowTriggerFormExternal(e,t){return e.getAttribute&&e.getAttribute(t)!==null},syncPendingRef(e,t,i){let n=e.getAttribute(W);return n===null?!0:Y.isFormInput(e)||e.getAttribute(i)!==null?(Y.isUploadInput(e)&&Y.mergeAttrs(e,t,{isIgnored:!0}),Y.putPrivate(e,W,t),!1):(lt.forEach(r=>{e.classList.contains(r)&&t.classList.add(r)}),t.setAttribute(W,n),!0)},cleanChildNodes(e,t){if(Y.isPhxUpdate(e,t,["append","prepend"])){let i=[];e.childNodes.forEach(n=>{n.id||(n.nodeType===Node.TEXT_NODE&&n.nodeValue.trim()===""||N(`only HTML element tags with an id are allowed inside containers with phx-update.

removing illegal node: "${(n.outerHTML||n.nodeValue).trim()}"

`),i.push(n))}),i.forEach(n=>n.remove())}},replaceRootContainer(e,t,i){let n=new Set(["id",ie,me,gt]);if(e.tagName.toLowerCase()===t.toLowerCase())return Array.from(e.attributes).filter(r=>!n.has(r.name.toLowerCase())).forEach(r=>e.removeAttribute(r.name)),Object.keys(i).filter(r=>!n.has(r.toLowerCase())).forEach(r=>e.setAttribute(r,i[r])),e;{let r=document.createElement(t);return Object.keys(i).forEach(a=>r.setAttribute(a,i[a])),n.forEach(a=>r.setAttribute(a,e.getAttribute(a))),r.innerHTML=e.innerHTML,e.replaceWith(r),r}}},p=Y,Qe=class{static isActive(e,t){let i=t._phxRef===void 0,r=e.getAttribute(Be).split(",").indexOf(j.genFileRef(t))>=0;return t.size>0&&(i||r)}static isPreflighted(e,t){return e.getAttribute($e).split(",").indexOf(j.genFileRef(t))>=0&&this.isActive(e,t)}constructor(e,t,i){this.ref=j.genFileRef(t),this.fileEl=e,this.file=t,this.view=i,this.meta=null,this._isCancelled=!1,this._isDone=!1,this._progress=0,this._lastProgressSent=-1,this._onDone=function(){},this._onElUpdated=this.onElUpdated.bind(this),this.fileEl.addEventListener(Je,this._onElUpdated)}metadata(){return this.meta}progress(e){this._progress=Math.floor(e),this._progress>this._lastProgressSent&&(this._progress>=100?(this._progress=100,this._lastProgressSent=100,this._isDone=!0,this.view.pushFileProgress(this.fileEl,this.ref,100,()=>{j.untrackFile(this.fileEl,this.file),this._onDone()})):(this._lastProgressSent=this._progress,this.view.pushFileProgress(this.fileEl,this.ref,this._progress)))}cancel(){this._isCancelled=!0,this._isDone=!0,this._onDone()}isDone(){return this._isDone}error(e="failed"){this.view.pushFileProgress(this.fileEl,this.ref,{error:e}),j.clearFiles(this.fileEl)}onDone(e){this._onDone=()=>{this.fileEl.removeEventListener(Je,this._onElUpdated),e()}}onElUpdated(){this.fileEl.getAttribute(Be).split(",").indexOf(this.ref)===-1&&this.cancel()}toPreflightPayload(){return{last_modified:this.file.lastModified,name:this.file.name,size:this.file.size,type:this.file.type,ref:this.ref}}uploader(e){if(this.meta.uploader){let t=e[this.meta.uploader]||N(`no uploader configured for ${this.meta.uploader}`);return{name:this.meta.uploader,callback:t}}else return{name:"channel",callback:fi}}zipPostFlight(e){this.meta=e.entries[this.ref],this.meta||N(`no preflight upload response returned with ref ${this.ref}`,{input:this.fileEl,response:e})}},pi=0,j=class{static genFileRef(e){let t=e._phxRef;return t!==void 0?t:(e._phxRef=(pi++).toString(),e._phxRef)}static getEntryDataURL(e,t,i){let n=this.activeFiles(e).find(r=>this.genFileRef(r)===t);i(URL.createObjectURL(n))}static hasUploadsInProgress(e){let t=0;return p.findUploadInputs(e).forEach(i=>{i.getAttribute($e)!==i.getAttribute(Yt)&&t++}),t>0}static serializeUploads(e){let t=this.activeFiles(e),i={};return t.forEach(n=>{let r={path:e.name},a=e.getAttribute(se);i[a]=i[a]||[],r.ref=this.genFileRef(n),r.name=n.name||r.ref,r.type=n.type,r.size=n.size,i[a].push(r)}),i}static clearFiles(e){e.value=null,e.removeAttribute(se),p.putPrivate(e,"files",[])}static untrackFile(e,t){p.putPrivate(e,"files",p.private(e,"files").filter(i=>!Object.is(i,t)))}static trackFiles(e,t){if(e.getAttribute("multiple")!==null){let i=t.filter(n=>!this.activeFiles(e).find(r=>Object.is(r,n)));p.putPrivate(e,"files",this.activeFiles(e).concat(i)),e.value=null}else p.putPrivate(e,"files",t)}static activeFileInputs(e){let t=p.findUploadInputs(e);return Array.from(t).filter(i=>i.files&&this.activeFiles(i).length>0)}static activeFiles(e){return(p.private(e,"files")||[]).filter(t=>Qe.isActive(e,t))}static inputsAwaitingPreflight(e){let t=p.findUploadInputs(e);return Array.from(t).filter(i=>this.filesAwaitingPreflight(i).length>0)}static filesAwaitingPreflight(e){return this.activeFiles(e).filter(t=>!Qe.isPreflighted(e,t))}constructor(e,t,i){this.view=t,this.onComplete=i,this._entries=Array.from(j.filesAwaitingPreflight(e)||[]).map(n=>new Qe(e,n,t)),this.numEntriesInProgress=this._entries.length}entries(){return this._entries}initAdapterUpload(e,t,i){this._entries=this._entries.map(r=>(r.zipPostFlight(e),r.onDone(()=>{this.numEntriesInProgress--,this.numEntriesInProgress===0&&this.onComplete()}),r));let n=this._entries.reduce((r,a)=>{let{name:h,callback:d}=a.uploader(i.uploaders);return r[h]=r[h]||{callback:d,entries:[]},r[h].entries.push(a),r},{});for(let r in n){let{callback:a,entries:h}=n[r];a(h,t,e,i)}}},vi={LiveFileUpload:{activeRefs(){return this.el.getAttribute(Be)},preflightedRefs(){return this.el.getAttribute($e)},mounted(){this.preflightedWas=this.preflightedRefs()},updated(){let e=this.preflightedRefs();this.preflightedWas!==e&&(this.preflightedWas=e,e===""&&this.__view.cancelSubmit(this.el.form)),this.activeRefs()===""&&(this.el.value=null),this.el.dispatchEvent(new CustomEvent(Je))}},LiveImgPreview:{mounted(){this.ref=this.el.getAttribute("data-phx-entry-ref"),this.inputEl=document.getElementById(this.el.getAttribute(se)),j.getEntryDataURL(this.inputEl,this.ref,e=>{this.url=e,this.el.src=e})},destroyed(){URL.revokeObjectURL(this.url)}}},gi=vi,mi=class{constructor(e,t,i){let n=new Set,r=new Set([...t.children].map(h=>h.id)),a=[];Array.from(e.children).forEach(h=>{if(h.id&&(n.add(h.id),r.has(h.id))){let d=h.previousElementSibling&&h.previousElementSibling.id;a.push({elementId:h.id,previousElementId:d})}}),this.containerId=t.id,this.updateType=i,this.elementsToModify=a,this.elementIdsToAdd=[...r].filter(h=>!n.has(h))}perform(){let e=p.byId(this.containerId);this.elementsToModify.forEach(t=>{t.previousElementId?z(document.getElementById(t.previousElementId),i=>{z(document.getElementById(t.elementId),n=>{n.previousElementSibling&&n.previousElementSibling.id==i.id||i.insertAdjacentElement("afterend",n)})}):z(document.getElementById(t.elementId),i=>{i.previousElementSibling==null||e.insertAdjacentElement("afterbegin",i)})}),this.updateType=="prepend"&&this.elementIdsToAdd.reverse().forEach(t=>{z(document.getElementById(t),i=>e.insertAdjacentElement("afterbegin",i))})}},Lt=11;function bi(e,t){var i=t.attributes,n,r,a,h,d;if(!(t.nodeType===Lt||e.nodeType===Lt)){for(var f=i.length-1;f>=0;f--)n=i[f],r=n.name,a=n.namespaceURI,h=n.value,a?(r=n.localName||r,d=e.getAttributeNS(a,r),d!==h&&(n.prefix==="xmlns"&&(r=n.name),e.setAttributeNS(a,r,h))):(d=e.getAttribute(r),d!==h&&e.setAttribute(r,h));for(var E=e.attributes,g=E.length-1;g>=0;g--)n=E[g],r=n.name,a=n.namespaceURI,a?(r=n.localName||r,t.hasAttributeNS(a,r)||e.removeAttributeNS(a,r)):t.hasAttribute(r)||e.removeAttribute(r)}}var Oe,yi="http://www.w3.org/1999/xhtml",M=typeof document=="undefined"?void 0:document,ki=!!M&&"content"in M.createElement("template"),wi=!!M&&M.createRange&&"createContextualFragment"in M.createRange();function Ai(e){var t=M.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}function Si(e){Oe||(Oe=M.createRange(),Oe.selectNode(M.body));var t=Oe.createContextualFragment(e);return t.childNodes[0]}function Ci(e){var t=M.createElement("body");return t.innerHTML=e,t.childNodes[0]}function Ei(e){return e=e.trim(),ki?Ai(e):wi?Si(e):Ci(e)}function He(e,t){var i=e.nodeName,n=t.nodeName,r,a;return i===n?!0:(r=i.charCodeAt(0),a=n.charCodeAt(0),r<=90&&a>=97?i===n.toUpperCase():a<=90&&r>=97?n===i.toUpperCase():!1)}function Ti(e,t){return!t||t===yi?M.createElement(e):M.createElementNS(t,e)}function _i(e,t){for(var i=e.firstChild;i;){var n=i.nextSibling;t.appendChild(i),i=n}return t}function Ze(e,t,i){e[i]!==t[i]&&(e[i]=t[i],e[i]?e.setAttribute(i,""):e.removeAttribute(i))}var Rt={OPTION:function(e,t){var i=e.parentNode;if(i){var n=i.nodeName.toUpperCase();n==="OPTGROUP"&&(i=i.parentNode,n=i&&i.nodeName.toUpperCase()),n==="SELECT"&&!i.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),i.selectedIndex=-1)}Ze(e,t,"selected")},INPUT:function(e,t){Ze(e,t,"checked"),Ze(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var i=t.value;e.value!==i&&(e.value=i);var n=e.firstChild;if(n){var r=n.nodeValue;if(r==i||!i&&r==e.placeholder)return;n.nodeValue=i}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var i=-1,n=0,r=e.firstChild,a,h;r;)if(h=r.nodeName&&r.nodeName.toUpperCase(),h==="OPTGROUP")a=r,r=a.firstChild;else{if(h==="OPTION"){if(r.hasAttribute("selected")){i=n;break}n++}r=r.nextSibling,!r&&a&&(r=a.nextSibling,a=null)}e.selectedIndex=i}}},Ae=1,Pi=11,It=3,Dt=8;function oe(){}function Li(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function Ri(e){return function(i,n,r){if(r||(r={}),typeof n=="string")if(i.nodeName==="#document"||i.nodeName==="HTML"||i.nodeName==="BODY"){var a=n;n=M.createElement("html"),n.innerHTML=a}else n=Ei(n);var h=r.getNodeKey||Li,d=r.onBeforeNodeAdded||oe,f=r.onNodeAdded||oe,E=r.onBeforeElUpdated||oe,g=r.onElUpdated||oe,T=r.onBeforeNodeDiscarded||oe,R=r.onNodeDiscarded||oe,I=r.onBeforeElChildrenUpdated||oe,_=r.childrenOnly===!0,O=Object.create(null),Q=[];function v(C){Q.push(C)}function D(C,S){if(C.nodeType===Ae)for(var A=C.firstChild;A;){var P=void 0;S&&(P=h(A))?v(P):(R(A),A.firstChild&&D(A,S)),A=A.nextSibling}}function X(C,S,A){T(C)!==!1&&(S&&S.removeChild(C),R(C),D(C,A))}function Z(C){if(C.nodeType===Ae||C.nodeType===Pi)for(var S=C.firstChild;S;){var A=h(S);A&&(O[A]=S),Z(S),S=S.nextSibling}}Z(i);function ae(C){f(C);for(var S=C.firstChild;S;){var A=S.nextSibling,P=h(S);if(P){var F=O[P];F&&He(S,F)?(S.parentNode.replaceChild(F,S),ee(F,S)):ae(S)}else ae(S);S=A}}function Ce(C,S,A){for(;S;){var P=S.nextSibling;(A=h(S))?v(A):X(S,C,!0),S=P}}function ee(C,S,A){var P=h(S);P&&delete O[P],!(!A&&(E(C,S)===!1||(e(C,S),g(C),I(C,S)===!1)))&&(C.nodeName!=="TEXTAREA"?fe(C,S):Rt.TEXTAREA(C,S))}function fe(C,S){var A=S.firstChild,P=C.firstChild,F,B,U,ue,V;e:for(;A;){for(ue=A.nextSibling,F=h(A);P;){if(U=P.nextSibling,A.isSameNode&&A.isSameNode(P)){A=ue,P=U;continue e}B=h(P);var c=P.nodeType,s=void 0;if(c===A.nodeType&&(c===Ae?(F?F!==B&&((V=O[F])?U===V?s=!1:(C.insertBefore(V,P),B?v(B):X(P,C,!0),P=V):s=!1):B&&(s=!1),s=s!==!1&&He(P,A),s&&ee(P,A)):(c===It||c==Dt)&&(s=!0,P.nodeValue!==A.nodeValue&&(P.nodeValue=A.nodeValue))),s){A=ue,P=U;continue e}B?v(B):X(P,C,!0),P=U}if(F&&(V=O[F])&&He(V,A))C.appendChild(V),ee(V,A);else{var o=d(A);o!==!1&&(o&&(A=o),A.actualize&&(A=A.actualize(C.ownerDocument||M)),C.appendChild(A),ae(A))}A=ue,P=U}Ce(C,P,B);var l=Rt[C.nodeName];l&&l(C,S)}var H=i,te=H.nodeType,le=n.nodeType;if(!_){if(te===Ae)le===Ae?He(i,n)||(R(i),H=_i(i,Ti(n.nodeName,n.namespaceURI))):H=n;else if(te===It||te===Dt){if(le===te)return H.nodeValue!==n.nodeValue&&(H.nodeValue=n.nodeValue),H;H=n}}if(H===n)R(i);else{if(n.isSameNode&&n.isSameNode(H))return;if(ee(H,n,_),Q)for(var pe=0,je=Q.length;pe<je;pe++){var he=O[Q[pe]];he&&X(he,he.parentNode,!1)}}return!_&&H!==i&&i.parentNode&&(H.actualize&&(H=H.actualize(i.ownerDocument||M)),i.parentNode.replaceChild(H,i)),H}}var Ii=Ri(bi),xt=Ii,Ne=class{static patchEl(e,t,i){xt(e,t,{childrenOnly:!1,onBeforeElUpdated:(n,r)=>{if(i&&i.isSameNode(n)&&p.isFormInput(n))return p.mergeFocusedInput(n,r),!1}})}constructor(e,t,i,n,r){this.view=e,this.liveSocket=e.liveSocket,this.container=t,this.id=i,this.rootID=e.root.id,this.html=n,this.targetCID=r,this.cidPatch=xe(this.targetCID),this.callbacks={beforeadded:[],beforeupdated:[],beforephxChildAdded:[],afteradded:[],afterupdated:[],afterdiscarded:[],afterphxChildAdded:[]}}before(e,t){this.callbacks[`before${e}`].push(t)}after(e,t){this.callbacks[`after${e}`].push(t)}trackBefore(e,...t){this.callbacks[`before${e}`].forEach(i=>i(...t))}trackAfter(e,...t){this.callbacks[`after${e}`].forEach(i=>i(...t))}markPrunableContentForRemoval(){p.all(this.container,"[phx-update=append] > *, [phx-update=prepend] > *",e=>{e.setAttribute(ct,"")})}perform(){let{view:e,liveSocket:t,container:i,html:n}=this,r=this.isCIDPatch()?this.targetCIDContainer(n):i;if(this.isCIDPatch()&&!r)return;let a=t.getActiveElement(),{selectionStart:h,selectionEnd:d}=a&&p.hasSelectionRange(a)?a:{},f=t.binding(Ke),E=t.binding(mt),g=t.binding(We),T=t.binding(Qt),R=[],I=[],_=[],O=null,Q=t.time("premorph container prep",()=>this.buildDiffHTML(i,n,f,r));return this.trackBefore("added",i),this.trackBefore("updated",i,i),t.time("morphdom",()=>{xt(r,Q,{childrenOnly:r.getAttribute(J)===null,getNodeKey:v=>p.isPhxDestroyed(v)?null:v.id,onBeforeNodeAdded:v=>(this.trackBefore("added",v),v),onNodeAdded:v=>{p.isNowTriggerFormExternal(v,T)&&(O=v),p.discardError(r,v,E),p.isPhxChild(v)&&e.ownsElement(v)&&this.trackAfter("phxChildAdded",v),R.push(v)},onNodeDiscarded:v=>{p.isPhxChild(v)&&t.destroyViewByEl(v),this.trackAfter("discarded",v)},onBeforeNodeDiscarded:v=>v.getAttribute&&v.getAttribute(ct)!==null?!0:!(v.parentNode!==null&&p.isPhxUpdate(v.parentNode,f,["append","prepend"])&&v.id||this.skipCIDSibling(v)),onElUpdated:v=>{p.isNowTriggerFormExternal(v,T)&&(O=v),I.push(v)},onBeforeElUpdated:(v,D)=>{if(p.cleanChildNodes(D,f),this.skipCIDSibling(D))return!1;if(p.isIgnored(v,f))return this.trackBefore("updated",v,D),p.mergeAttrs(v,D,{isIgnored:!0}),I.push(v),!1;if(v.type==="number"&&v.validity&&v.validity.badInput)return!1;if(!p.syncPendingRef(v,D,g))return p.isUploadInput(v)&&(this.trackBefore("updated",v,D),I.push(v)),!1;if(p.isPhxChild(D)){let Z=v.getAttribute(ie);return p.mergeAttrs(v,D,{exclude:[me]}),Z!==""&&v.setAttribute(ie,Z),v.setAttribute(Pe,this.rootID),!1}return p.copyPrivates(D,v),p.discardError(r,D,E),p.syncPropsToAttrs(D),a&&v.isSameNode(a)&&p.isFormInput(v)&&!this.forceFocusedSelectUpdate(v,D)?(this.trackBefore("updated",v,D),p.mergeFocusedInput(v,D),p.syncAttrsToProps(v),I.push(v),!1):(p.isPhxUpdate(D,f,["append","prepend"])&&_.push(new mi(v,D,D.getAttribute(f))),p.syncAttrsToProps(D),this.trackBefore("updated",v,D),!0)}})}),t.isDebugEnabled()&&ui(),_.length>0&&t.time("post-morph append/prepend restoration",()=>{_.forEach(v=>v.perform())}),t.silenceEvents(()=>p.restoreFocus(a,h,d)),p.dispatchEvent(document,"phx:update"),R.forEach(v=>this.trackAfter("added",v)),I.forEach(v=>this.trackAfter("updated",v)),O&&(t.disconnect(),O.submit()),!0}forceFocusedSelectUpdate(e,t){let i=["select","select-one","select-multiple"].find(n=>n===e.type);return e.multiple===!0||i&&e.innerHTML!=t.innerHTML}isCIDPatch(){return this.cidPatch}skipCIDSibling(e){return e.nodeType===Node.ELEMENT_NODE&&e.getAttribute(Ve)!==null}targetCIDContainer(e){if(!this.isCIDPatch())return;let[t,...i]=p.findComponentNodeList(this.container,this.targetCID);return i.length===0&&p.childNodeLength(e)===1?t:t&&t.parentNode}buildDiffHTML(e,t,i,n){let r=this.isCIDPatch(),a=r&&n.getAttribute(J)===this.targetCID.toString();if(!r||a)return t;{let h=null,d=document.createElement("template");h=p.cloneNode(n);let[f,...E]=p.findComponentNodeList(h,this.targetCID);return d.innerHTML=t,E.forEach(g=>g.remove()),Array.from(h.childNodes).forEach(g=>{g.id&&g.nodeType===Node.ELEMENT_NODE&&g.getAttribute(J)!==this.targetCID.toString()&&(g.setAttribute(Ve,""),g.innerHTML="")}),Array.from(d.content.childNodes).forEach(g=>h.insertBefore(g,f)),f.remove(),h.outerHTML}}},Ot=class{static extract(e){let{[Et]:t,[Ct]:i,[Tt]:n}=e;return delete e[Et],delete e[Ct],delete e[Tt],{diff:e,title:n,reply:t||null,events:i||[]}}constructor(e,t){this.viewId=e,this.rendered={},this.mergeDiff(t)}parentViewId(){return this.viewId}toString(e){return this.recursiveToString(this.rendered,this.rendered[$],e)}recursiveToString(e,t=e[$],i){i=i?new Set(i):null;let n={buffer:"",components:t,onlyCids:i};return this.toOutputBuffer(e,n),n.buffer}componentCIDs(e){return Object.keys(e[$]||{}).map(t=>parseInt(t))}isComponentOnlyDiff(e){return e[$]?Object.keys(e).length===1:!1}getComponent(e,t){return e[$][t]}mergeDiff(e){let t=e[$],i={};if(delete e[$],this.rendered=this.mutableMerge(this.rendered,e),this.rendered[$]=this.rendered[$]||{},t){let r=this.rendered[$];for(let a in t)t[a]=this.cachedFindComponent(a,t[a],r,t,i);for(var n in t)r[n]=t[n];e[$]=t}}cachedFindComponent(e,t,i,n,r){if(r[e])return r[e];{let a,h,d=t[q];if(xe(d)){let f;d>0?f=this.cachedFindComponent(d,n[d],i,n,r):f=i[-d],h=f[q],a=this.cloneMerge(f,t),a[q]=h}else a=t[q]!==void 0?t:this.cloneMerge(i[e]||{},t);return r[e]=a,a}}mutableMerge(e,t){return t[q]!==void 0?t:(this.doMutableMerge(e,t),e)}doMutableMerge(e,t){for(let i in t){let n=t[i],r=e[i];we(n)&&n[q]===void 0&&we(r)?this.doMutableMerge(r,n):e[i]=n}}cloneMerge(e,t){let i=Te(Te({},e),t);for(let n in i){let r=t[n],a=e[n];we(r)&&r[q]===void 0&&we(a)&&(i[n]=this.cloneMerge(a,r))}return i}componentToString(e){return this.recursiveCIDToString(this.rendered[$],e)}pruneCIDs(e){e.forEach(t=>delete this.rendered[$][t])}get(){return this.rendered}isNewFingerprint(e={}){return!!e[q]}toOutputBuffer(e,t){if(e[St])return this.comprehensionToBuffer(e,t);let{[q]:i}=e;t.buffer+=i[0];for(let n=1;n<i.length;n++)this.dynamicToBuffer(e[n-1],t),t.buffer+=i[n]}comprehensionToBuffer(e,t){let{[St]:i,[q]:n}=e;for(let r=0;r<i.length;r++){let a=i[r];t.buffer+=n[0];for(let h=1;h<n.length;h++)this.dynamicToBuffer(a[h-1],t),t.buffer+=n[h]}}dynamicToBuffer(e,t){typeof e=="number"?t.buffer+=this.recursiveCIDToString(t.components,e,t.onlyCids):we(e)?this.toOutputBuffer(e,t):t.buffer+=e}recursiveCIDToString(e,t,i){let n=e[t]||N(`no component for CID ${t}`,e),r=document.createElement("template");r.innerHTML=this.recursiveToString(n,e,i);let a=r.content,h=i&&!i.has(t),[d,f]=Array.from(a.childNodes).reduce(([E,g],T,R)=>T.nodeType===Node.ELEMENT_NODE?T.getAttribute(J)?[E,!0]:(T.setAttribute(J,t),T.id||(T.id=`${this.parentViewId()}-${t}-${R}`),h&&(T.setAttribute(Ve,""),T.innerHTML=""),[!0,g]):T.nodeValue.trim()!==""?(N(`only HTML element tags are allowed at the root of components.

got: "${T.nodeValue.trim()}"

within:
`,r.innerHTML.trim()),T.replaceWith(this.createSpan(T.nodeValue,t)),[!0,g]):(T.remove(),[E,g]),[!1,!1]);return!d&&!f?(N(`expected at least one HTML element tag inside a component, but the component is empty:
`,r.innerHTML.trim()),this.createSpan("",t).outerHTML):(!d&&f&&N("expected at least one HTML element tag directly inside a component, but only subcomponents were found. A component must render at least one HTML tag directly inside itself.",r.innerHTML.trim()),r.innerHTML)}createSpan(e,t){let i=document.createElement("span");return i.innerText=e,i.setAttribute(J,t),i}},Di=1,Se=class{static makeID(){return Di++}static elementID(e){return e.phxHookId}constructor(e,t,i){this.__view=e,this.__liveSocket=e.liveSocket,this.__callbacks=i,this.__listeners=new Set,this.__isDisconnected=!1,this.el=t,this.el.phxHookId=this.constructor.makeID();for(let n in this.__callbacks)this[n]=this.__callbacks[n]}__mounted(){this.mounted&&this.mounted()}__updated(){this.updated&&this.updated()}__beforeUpdate(){this.beforeUpdate&&this.beforeUpdate()}__destroyed(){this.destroyed&&this.destroyed()}__reconnected(){this.__isDisconnected&&(this.__isDisconnected=!1,this.reconnected&&this.reconnected())}__disconnected(){this.__isDisconnected=!0,this.disconnected&&this.disconnected()}pushEvent(e,t={},i=function(){}){return this.__view.pushHookEvent(null,e,t,i)}pushEventTo(e,t,i={},n=function(){}){return this.__view.withinTargets(e,(r,a)=>r.pushHookEvent(a,t,i,n))}handleEvent(e,t){let i=(n,r)=>r?e:t(n.detail);return window.addEventListener(`phx:hook:${e}`,i),this.__listeners.add(i),i}removeHandleEvent(e){let t=e(null,!0);window.removeEventListener(`phx:hook:${t}`,e),this.__listeners.delete(e)}upload(e,t){return this.__view.dispatchUploads(e,t)}uploadTo(e,t,i){return this.__view.withinTargets(e,n=>n.dispatchUploads(t,i))}__cleanup__(){this.__listeners.forEach(e=>this.removeHandleEvent(e))}},et=(e,t={})=>{let i=new FormData(e),n=[];i.forEach((a,h,d)=>{a instanceof File&&n.push(h)}),n.forEach(a=>i.delete(a));let r=new URLSearchParams;for(let[a,h]of i.entries())r.append(a,h);for(let a in t)r.append(a,t[a]);return r.toString()},Ht=class{constructor(e,t,i,n){this.liveSocket=t,this.flash=n,this.parent=i,this.root=i?i.root:this,this.el=e,this.id=this.el.id,this.ref=0,this.childJoins=0,this.loaderTimer=null,this.pendingDiffs=[],this.pruningCIDs=[],this.redirect=!1,this.href=null,this.joinCount=this.parent?this.parent.joinCount-1:0,this.joinPending=!0,this.destroyed=!1,this.joinCallback=function(){},this.stopCallback=function(){},this.pendingJoinOps=this.parent?null:[],this.viewHooks={},this.uploaders={},this.formSubmits=[],this.children=this.parent?null:{},this.root.children[this.id]={},this.channel=this.liveSocket.channel(`lv:${this.id}`,()=>({redirect:this.redirect?this.href:void 0,url:this.redirect?void 0:this.href||void 0,params:this.connectParams(),session:this.getSession(),static:this.getStatic(),flash:this.flash})),this.showLoader(this.liveSocket.loaderTimeout),this.bindChannel()}setHref(e){this.href=e}setRedirect(e){this.redirect=!0,this.href=e}isMain(){return this.liveSocket.main===this}connectParams(){let e=this.liveSocket.params(this.el),t=p.all(document,`[${this.binding(Gt)}]`).map(i=>i.src||i.href).filter(i=>typeof i=="string");return t.length>0&&(e._track_static=t),e._mounts=this.joinCount,e}isConnected(){return this.channel.canPush()}getSession(){return this.el.getAttribute(ie)}getStatic(){let e=this.el.getAttribute(me);return e===""?null:e}destroy(e=function(){}){this.destroyAllChildren(),this.destroyed=!0,delete this.root.children[this.id],this.parent&&delete this.root.children[this.parent.id][this.id],clearTimeout(this.loaderTimer);let t=()=>{e();for(let i in this.viewHooks)this.destroyHook(this.viewHooks[i])};p.markPhxChildDestroyed(this.el),this.log("destroyed",()=>["the child has been removed from the parent"]),this.channel.leave().receive("ok",t).receive("error",t).receive("timeout",t)}setContainerClasses(...e){this.el.classList.remove(ft,_e,vt),this.el.classList.add(...e)}isLoading(){return this.el.classList.contains(_e)}showLoader(e){if(clearTimeout(this.loaderTimer),e)this.loaderTimer=setTimeout(()=>this.showLoader(),e);else{for(let t in this.viewHooks)this.viewHooks[t].__disconnected();this.setContainerClasses(_e)}}hideLoader(){clearTimeout(this.loaderTimer),this.setContainerClasses(ft)}triggerReconnected(){for(let e in this.viewHooks)this.viewHooks[e].__reconnected()}log(e,t){this.liveSocket.log(this,e,t)}withinTargets(e,t){if(e instanceof HTMLElement)return this.liveSocket.owner(e,i=>t(i,e));if(/^(0|[1-9]\d*)$/.test(e)){let i=p.findComponentNodeList(this.el,e);i.length===0?N(`no component found matching phx-target of ${e}`):t(this,i[0])}else{let i=Array.from(document.querySelectorAll(e));i.length===0&&N(`nothing found matching the phx-target selector "${e}"`),i.forEach(n=>this.liveSocket.owner(n,r=>t(r,n)))}}applyDiff(e,t,i){this.log(e,()=>["",ye(t)]);let{diff:n,reply:r,events:a,title:h}=Ot.extract(t);return h&&p.putTitle(h),i({diff:n,reply:r,events:a}),r}onJoin(e){let{rendered:t,container:i}=e;if(i){let[n,r]=i;this.el=p.replaceRootContainer(this.el,n,r)}this.childJoins=0,this.joinPending=!0,this.flash=null,ne.dropLocal(this.liveSocket.localStorage,window.location.pathname,ot),this.applyDiff("mount",t,({diff:n,events:r})=>{this.rendered=new Ot(this.id,n);let a=this.renderContainer(null,"join");this.dropPendingRefs();let h=this.formsForRecovery(a);this.joinCount++,h.length>0?h.forEach(([d,f,E],g)=>{this.pushFormRecovery(d,E,T=>{g===h.length-1&&this.onJoinComplete(T,a,r)})}):this.onJoinComplete(e,a,r)})}dropPendingRefs(){p.all(this.el,`[${W}]`,e=>e.removeAttribute(W))}onJoinComplete({live_patch:e},t,i){if(this.joinCount>1||this.parent&&!this.parent.isJoinPending())return this.applyJoinPatch(e,t,i);p.findPhxChildrenInFragment(t,this.id).filter(r=>{let a=r.id&&this.el.querySelector(`[id="${r.id}"]`),h=a&&a.getAttribute(me);return h&&r.setAttribute(me,h),this.joinChild(r)}).length===0?this.parent?(this.root.pendingJoinOps.push([this,()=>this.applyJoinPatch(e,t,i)]),this.parent.ackJoin(this)):(this.onAllChildJoinsComplete(),this.applyJoinPatch(e,t,i)):this.root.pendingJoinOps.push([this,()=>this.applyJoinPatch(e,t,i)])}attachTrueDocEl(){this.el=p.byId(this.id),this.el.setAttribute(Pe,this.root.id)}dispatchEvents(e){e.forEach(([t,i])=>{window.dispatchEvent(new CustomEvent(`phx:hook:${t}`,{detail:i}))})}applyJoinPatch(e,t,i){this.attachTrueDocEl();let n=new Ne(this,this.el,this.id,t,null);if(n.markPrunableContentForRemoval(),this.performPatch(n,!1),this.joinNewChildren(),p.all(this.el,`[${this.binding(Ie)}], [data-phx-${Ie}]`,r=>{let a=this.addHook(r);a&&a.__mounted()}),this.joinPending=!1,this.dispatchEvents(i),this.applyPendingUpdates(),e){let{kind:r,to:a}=e;this.liveSocket.historyPatch(a,r)}this.hideLoader(),this.joinCount>1&&this.triggerReconnected(),this.stopCallback()}triggerBeforeUpdateHook(e,t){this.liveSocket.triggerDOM("onBeforeElUpdated",[e,t]);let i=this.getHook(e),n=i&&p.isIgnored(e,this.binding(Ke));if(i&&!e.isEqualNode(t)&&!(n&&di(e.dataset,t.dataset)))return i.__beforeUpdate(),i}performPatch(e,t){let i=[],n=!1,r=new Set;return e.after("added",a=>{this.liveSocket.triggerDOM("onNodeAdded",[a]);let h=this.addHook(a);h&&h.__mounted()}),e.after("phxChildAdded",a=>n=!0),e.before("updated",(a,h)=>{this.triggerBeforeUpdateHook(a,h)&&r.add(a.id)}),e.after("updated",a=>{r.has(a.id)&&this.getHook(a).__updated()}),e.after("discarded",a=>{let h=this.componentID(a);xe(h)&&i.indexOf(h)===-1&&i.push(h);let d=this.getHook(a);d&&this.destroyHook(d)}),e.perform(),t&&this.maybePushComponentsDestroyed(i),n}joinNewChildren(){p.findPhxChildren(this.el,this.id).forEach(e=>this.joinChild(e))}getChildById(e){return this.root.children[this.id][e]}getDescendentByEl(e){return e.id===this.id?this:this.children[e.getAttribute(ge)][e.id]}destroyDescendent(e){for(let t in this.root.children)for(let i in this.root.children[t])if(i===e)return this.root.children[t][i].destroy()}joinChild(e){if(!this.getChildById(e.id)){let i=new Ht(e,this.liveSocket,this);return this.root.children[this.id][i.id]=i,i.join(),this.childJoins++,!0}}isJoinPending(){return this.joinPending}ackJoin(e){this.childJoins--,this.childJoins===0&&(this.parent?this.parent.ackJoin(this):this.onAllChildJoinsComplete())}onAllChildJoinsComplete(){this.joinCallback(),this.pendingJoinOps.forEach(([e,t])=>{e.isDestroyed()||t()}),this.pendingJoinOps=[]}update(e,t){if(this.isJoinPending()||this.liveSocket.hasPendingLink())return this.pendingDiffs.push({diff:e,events:t});this.rendered.mergeDiff(e);let i=!1;this.rendered.isComponentOnlyDiff(e)?this.liveSocket.time("component patch complete",()=>{p.findParentCIDs(this.el,this.rendered.componentCIDs(e)).forEach(r=>{this.componentPatch(this.rendered.getComponent(e,r),r)&&(i=!0)})}):_t(e)||this.liveSocket.time("full patch complete",()=>{let n=this.renderContainer(e,"update"),r=new Ne(this,this.el,this.id,n,null);i=this.performPatch(r,!0)}),this.dispatchEvents(t),i&&this.joinNewChildren()}renderContainer(e,t){return this.liveSocket.time(`toString diff (${t})`,()=>{let i=this.el.tagName,n=e?this.rendered.componentCIDs(e).concat(this.pruningCIDs):null,r=this.rendered.toString(n);return`<${i}>${r}</${i}>`})}componentPatch(e,t){if(_t(e))return!1;let i=this.rendered.componentToString(t),n=new Ne(this,this.el,this.id,i,t);return this.performPatch(n,!0)}getHook(e){return this.viewHooks[Se.elementID(e)]}addHook(e){if(Se.elementID(e)||!e.getAttribute)return;let t=e.getAttribute(`data-phx-${Ie}`)||e.getAttribute(this.binding(Ie));if(t&&!this.ownsElement(e))return;let i=this.liveSocket.getHookCallbacks(t);if(i){e.id||N(`no DOM ID for hook "${t}". Hooks require a unique ID on each element.`,e);let n=new Se(this,e,i);return this.viewHooks[Se.elementID(n.el)]=n,n}else t!==null&&N(`unknown hook found for "${t}"`,e)}destroyHook(e){e.__destroyed(),e.__cleanup__(),delete this.viewHooks[Se.elementID(e.el)]}applyPendingUpdates(){this.pendingDiffs.forEach(({diff:e,events:t})=>this.update(e,t)),this.pendingDiffs=[]}onChannel(e,t){this.liveSocket.onChannel(this.channel,e,i=>{this.isJoinPending()?this.root.pendingJoinOps.push([this,()=>t(i)]):t(i)})}bindChannel(){this.liveSocket.onChannel(this.channel,"diff",e=>{this.applyDiff("update",e,({diff:t,events:i})=>this.update(t,i))}),this.onChannel("redirect",({to:e,flash:t})=>this.onRedirect({to:e,flash:t})),this.onChannel("live_patch",e=>this.onLivePatch(e)),this.onChannel("live_redirect",e=>this.onLiveRedirect(e)),this.channel.onError(e=>this.onError(e)),this.channel.onClose(e=>this.onClose(e))}destroyAllChildren(){for(let e in this.root.children[this.id])this.getChildById(e).destroy()}onLiveRedirect(e){let{to:t,kind:i,flash:n}=e,r=this.expandURL(t);this.liveSocket.historyRedirect(r,i,n)}onLivePatch(e){let{to:t,kind:i}=e;this.href=this.expandURL(t),this.liveSocket.historyPatch(t,i)}expandURL(e){return e.startsWith("/")?`${window.location.protocol}//${window.location.host}${e}`:e}onRedirect({to:e,flash:t}){this.liveSocket.redirect(e,t)}isDestroyed(){return this.destroyed}join(e){this.parent||(this.stopCallback=this.liveSocket.withPageLoading({to:this.href,kind:"initial"})),this.joinCallback=()=>e&&e(this.joinCount),this.liveSocket.wrapPush(this,{timeout:!1},()=>this.channel.join().receive("ok",t=>!this.isDestroyed()&&this.onJoin(t)).receive("error",t=>!this.isDestroyed()&&this.onJoinError(t)).receive("timeout",()=>!this.isDestroyed()&&this.onJoinError({reason:"timeout"})))}onJoinError(e){return e.reason==="unauthorized"||e.reason==="stale"?(this.log("error",()=>["unauthorized live_redirect. Falling back to page request",e]),this.onRedirect({to:this.href})):((e.redirect||e.live_redirect)&&(this.joinPending=!1,this.channel.leave()),e.redirect?this.onRedirect(e.redirect):e.live_redirect?this.onLiveRedirect(e.live_redirect):(this.log("error",()=>["unable to join",e]),this.liveSocket.reloadWithJitter(this)))}onClose(e){if(!this.isDestroyed()){if(this.isJoinPending()&&document.visibilityState!=="hidden"||this.liveSocket.hasPendingLink()&&e!=="leave")return this.liveSocket.reloadWithJitter(this);this.destroyAllChildren(),this.liveSocket.dropActiveElement(this),document.activeElement&&document.activeElement.blur(),this.liveSocket.isUnloaded()&&this.showLoader(si)}}onError(e){this.onClose(e),this.log("error",()=>["view crashed",e]),this.liveSocket.isUnloaded()||this.displayError()}displayError(){this.isMain()&&p.dispatchEvent(window,"phx:page-loading-start",{to:this.href,kind:"error"}),this.showLoader(),this.setContainerClasses(_e,vt)}pushWithReply(e,t,i,n=function(){}){if(!this.isConnected())return;let[r,[a]]=e?e():[null,[]],h=function(){};return a&&a.getAttribute(this.binding(dt))!==null&&(h=this.liveSocket.withPageLoading({kind:"element",target:a})),typeof i.cid!="number"&&delete i.cid,this.liveSocket.wrapPush(this,{timeout:!0},()=>this.channel.push(t,i,ai).receive("ok",d=>{let f=null;r!==null&&this.undoRefs(r),d.diff&&(f=this.applyDiff("update",d.diff,({diff:E,events:g})=>{this.update(E,g)})),d.redirect&&this.onRedirect(d.redirect),d.live_patch&&this.onLivePatch(d.live_patch),d.live_redirect&&this.onLiveRedirect(d.live_redirect),h(),n(d,f)}))}undoRefs(e){p.all(this.el,`[${W}="${e}"]`,t=>{let i=t.getAttribute(Le);t.removeAttribute(W),t.getAttribute(Xe)!==null&&(t.readOnly=!1,t.removeAttribute(Xe)),i!==null&&(t.disabled=i==="true",t.removeAttribute(Le)),lt.forEach(a=>p.removeClass(t,a));let n=t.getAttribute(Re);n!==null&&(t.innerText=n,t.removeAttribute(Re));let r=p.private(t,W);if(r){let a=this.triggerBeforeUpdateHook(t,r);Ne.patchEl(t,r,this.liveSocket.getActiveElement()),a&&a.__updated(),p.deletePrivate(t,W)}})}putRef(e,t){let i=this.ref++,n=this.binding(We);return e.forEach(r=>{r.classList.add(`phx-${t}-loading`),r.setAttribute(W,i);let a=r.getAttribute(n);a!==null&&(r.getAttribute(Re)||r.setAttribute(Re,r.innerText),r.innerText=a)}),[i,e]}componentID(e){let t=e.getAttribute&&e.getAttribute(J);return t?parseInt(t):null}targetComponentID(e,t){return e.getAttribute(this.binding("target"))?this.closestComponentID(t):null}closestComponentID(e){return e?z(e.closest(`[${J}]`),t=>this.ownsElement(t)&&this.componentID(t)):null}pushHookEvent(e,t,i,n){if(!this.isConnected())return this.log("hook",()=>["unable to push hook event. LiveView not connected",t,i]),!1;let[r,a]=this.putRef([],"hook");return this.pushWithReply(()=>[r,a],"event",{type:"hook",event:t,value:i,cid:this.closestComponentID(e)},(h,d)=>n(d,r)),r}extractMeta(e,t){let i=this.binding("value-");for(let n=0;n<e.attributes.length;n++){let r=e.attributes[n].name;r.startsWith(i)&&(t[r.replace(i,"")]=e.getAttribute(r))}return e.value!==void 0&&(t.value=e.value,e.tagName==="INPUT"&&yt.indexOf(e.type)>=0&&!e.checked&&delete t.value),t}pushEvent(e,t,i,n,r){this.pushWithReply(()=>this.putRef([t],e),"event",{type:e,event:n,value:this.extractMeta(t,r),cid:this.targetComponentID(t,i)})}pushKey(e,t,i,n,r){this.pushWithReply(()=>this.putRef([e],i),"event",{type:i,event:n,value:this.extractMeta(e,r),cid:this.targetComponentID(e,t)})}pushFileProgress(e,t,i,n=function(){}){this.liveSocket.withinOwners(e.form,(r,a)=>{r.pushWithReply(null,"progress",{event:e.getAttribute(r.binding(ni)),ref:e.getAttribute(se),entry_ref:t,progress:i,cid:r.targetComponentID(e.form,a)},n)})}pushInput(e,t,i,n,r,a){let h,d=xe(i)?i:this.targetComponentID(e.form,t),f=()=>this.putRef([e,e.form],"change"),E=et(e.form,{_target:r.name});e.files&&e.files.length>0&&j.trackFiles(e,Array.from(e.files)),h=j.serializeUploads(e);let g={type:"form",event:n,value:E,uploads:h,cid:d};this.pushWithReply(f,"event",g,T=>{if(p.showError(e,this.liveSocket.binding(mt)),p.isUploadInput(e)&&e.getAttribute("data-phx-auto-upload")!==null){if(j.filesAwaitingPreflight(e).length>0){let[R,I]=f();this.uploadFiles(e.form,t,R,d,_=>{a&&a(T),this.triggerAwaitingSubmit(e.form)})}}else a&&a(T)})}triggerAwaitingSubmit(e){let t=this.getScheduledSubmit(e);if(t){let[i,n,r]=t;this.cancelSubmit(e),r()}}getScheduledSubmit(e){return this.formSubmits.find(([t,i])=>t.isSameNode(e))}scheduleSubmit(e,t,i){if(this.getScheduledSubmit(e))return!0;this.formSubmits.push([e,t,i])}cancelSubmit(e){this.formSubmits=this.formSubmits.filter(([t,i,n])=>t.isSameNode(e)?(this.undoRefs(i),!1):!0)}pushFormSubmit(e,t,i,n){let r=g=>!(ke(g,`${this.binding(Ke)}=ignore`,g.form)||ke(g,"data-phx-update=ignore",g.form)),a=g=>g.hasAttribute(this.binding(We)),h=g=>g.tagName=="BUTTON",d=g=>["INPUT","TEXTAREA","SELECT"].includes(g.tagName),f=()=>{let g=Array.from(e.elements),T=g.filter(a),R=g.filter(h).filter(r),I=g.filter(d).filter(r);return R.forEach(_=>{_.setAttribute(Le,_.disabled),_.disabled=!0}),I.forEach(_=>{_.setAttribute(Xe,_.readOnly),_.readOnly=!0,_.files&&(_.setAttribute(Le,_.disabled),_.disabled=!0)}),e.setAttribute(this.binding(dt),""),this.putRef([e].concat(T).concat(R).concat(I),"submit")},E=this.targetComponentID(e,t);if(j.hasUploadsInProgress(e)){let[g,T]=f();return this.scheduleSubmit(e,g,()=>this.pushFormSubmit(e,t,i,n))}else if(j.inputsAwaitingPreflight(e).length>0){let[g,T]=f(),R=()=>[g,T];this.uploadFiles(e,t,g,E,I=>{let _=et(e,{});this.pushWithReply(R,"event",{type:"form",event:i,value:_,cid:E},n)})}else{let g=et(e);this.pushWithReply(f,"event",{type:"form",event:i,value:g,cid:E},n)}}uploadFiles(e,t,i,n,r){let a=this.joinCount,h=j.activeFileInputs(e),d=h.length;h.forEach(f=>{let E=new j(f,this,()=>{d--,d===0&&r()});this.uploaders[f]=E;let g=E.entries().map(R=>R.toPreflightPayload()),T={ref:f.getAttribute(se),entries:g,cid:this.targetComponentID(f.form,t)};this.log("upload",()=>["sending preflight request",T]),this.pushWithReply(null,"allow_upload",T,R=>{if(this.log("upload",()=>["got preflight response",R]),R.error){this.undoRefs(i);let[I,_]=R.error;this.log("upload",()=>[`error for entry ${I}`,_])}else{let I=_=>{this.channel.onError(()=>{this.joinCount===a&&_()})};E.initAdapterUpload(R,I,this.liveSocket)}})})}dispatchUploads(e,t){let i=p.findUploadInputs(this.el).filter(n=>n.name===e);i.length===0?N(`no live file inputs found matching the name "${e}"`):i.length>1?N(`duplicate live file inputs found matching the name "${e}"`):p.dispatchEvent(i[0],ht,{files:t})}pushFormRecovery(e,t,i){this.liveSocket.withinOwners(e,(n,r)=>{let a=e.elements[0],h=e.getAttribute(this.binding(wt))||e.getAttribute(this.binding("change"));n.pushInput(a,r,t,h,a,i)})}pushLinkPatch(e,t,i){let n=this.liveSocket.setPendingLink(e),r=t?()=>this.putRef([t],"click"):null;this.pushWithReply(r,"live_patch",{url:e},a=>{a.link_redirect?this.liveSocket.replaceMain(e,null,i,n):(this.liveSocket.commitPendingLink(n)&&(this.href=e),this.applyPendingUpdates(),i&&i(n))}).receive("timeout",()=>this.liveSocket.redirect(window.location.href))}formsForRecovery(e){if(this.joinCount===0)return[];let t=this.binding("change"),i=document.createElement("template");return i.innerHTML=e,p.all(this.el,`form[${t}]`).filter(n=>n.id&&this.ownsElement(n)).filter(n=>n.elements.length>0).filter(n=>n.getAttribute(this.binding(wt))!=="ignore").map(n=>{let r=i.content.querySelector(`form[id="${n.id}"][${t}="${n.getAttribute(t)}"]`);return r?[n,r,this.componentID(r)]:[n,null,null]}).filter(([n,r,a])=>r)}maybePushComponentsDestroyed(e){let t=e.filter(i=>p.findComponentNodeList(this.el,i).length===0);t.length>0&&(this.pruningCIDs.push(...t),this.pushWithReply(null,"cids_will_destroy",{cids:t},()=>{this.pruningCIDs=this.pruningCIDs.filter(n=>t.indexOf(n)!==-1);let i=t.filter(n=>p.findComponentNodeList(this.el,n).length===0);i.length>0&&this.pushWithReply(null,"cids_destroyed",{cids:i},n=>{this.rendered.pruneCIDs(n.cids)})}))}ownsElement(e){return e.getAttribute(ge)===this.id||z(e.closest(de),t=>t.id)===this.id}submitForm(e,t,i){p.putPrivate(e,kt,!0),this.liveSocket.blurActiveElement(this),this.pushFormSubmit(e,t,i,()=>{this.liveSocket.restorePreviouslyActiveFocus()})}binding(e){return this.liveSocket.binding(e)}},Nt=class{constructor(e,t,i={}){if(this.unloaded=!1,!t||t.constructor.name==="Object")throw new Error(`
      a phoenix Socket must be provided as the second argument to the LiveSocket constructor. For example:

          import {Socket} from "phoenix"
          import LiveSocket from "phoenix_live_view"
          let liveSocket = new LiveSocket("/live", Socket, {...})
      `);this.socket=new t(e,i),this.bindingPrefix=i.bindingPrefix||oi,this.opts=i,this.params=Ye(i.params||{}),this.viewLogger=i.viewLogger,this.metadataCallbacks=i.metadata||{},this.defaults=Object.assign(ye(li),i.defaults||{}),this.activeElement=null,this.prevActive=null,this.silenced=!1,this.main=null,this.linkRef=1,this.roots={},this.href=window.location.href,this.pendingLink=null,this.currentLocation=ye(window.location),this.hooks=i.hooks||{},this.uploaders=i.uploaders||{},this.loaderTimeout=i.loaderTimeout||ri,this.localStorage=i.localStorage||window.localStorage,this.sessionStorage=i.sessionStorage||window.sessionStorage,this.boundTopLevelEvents=!1,this.domCallbacks=Object.assign({onNodeAdded:Ye(),onBeforeElUpdated:Ye()},i.dom||{}),window.addEventListener("pagehide",n=>{this.unloaded=!0}),this.socket.onOpen(()=>{this.isUnloaded()&&window.location.reload()})}isProfileEnabled(){return this.sessionStorage.getItem(Ge)==="true"}isDebugEnabled(){return this.sessionStorage.getItem(qe)==="true"}enableDebug(){this.sessionStorage.setItem(qe,"true")}enableProfiling(){this.sessionStorage.setItem(Ge,"true")}disableDebug(){this.sessionStorage.removeItem(qe)}disableProfiling(){this.sessionStorage.removeItem(Ge)}enableLatencySim(e){this.enableDebug(),console.log("latency simulator enabled for the duration of this browser session. Call disableLatencySim() to disable"),this.sessionStorage.setItem(ze,e)}disableLatencySim(){this.sessionStorage.removeItem(ze)}getLatencySim(){let e=this.sessionStorage.getItem(ze);return e?parseInt(e):null}getSocket(){return this.socket}connect(){let e=()=>{this.joinRootViews()&&(this.bindTopLevelEvents(),this.socket.connect())};["complete","loaded","interactive"].indexOf(document.readyState)>=0?e():document.addEventListener("DOMContentLoaded",()=>e())}disconnect(e){this.socket.disconnect(e)}triggerDOM(e,t){this.domCallbacks[e](...t)}time(e,t){if(!this.isProfileEnabled()||!console.time)return t();console.time(e);let i=t();return console.timeEnd(e),i}log(e,t,i){if(this.viewLogger){let[n,r]=i();this.viewLogger(e,t,n,r)}else if(this.isDebugEnabled()){let[n,r]=i();ci(e,t,n,r)}}onChannel(e,t,i){e.on(t,n=>{let r=this.getLatencySim();r?(console.log(`simulating ${r}ms of latency from server to client`),setTimeout(()=>i(n),r)):i(n)})}wrapPush(e,t,i){let n=this.getLatencySim(),r=e.joinCount;if(!n)return t.timeout?i().receive("timeout",()=>{e.joinCount===r&&!e.isDestroyed()&&this.reloadWithJitter(e,()=>{this.log(e,"timeout",()=>["received timeout while communicating with server. Falling back to hard refresh for recovery"])})}):i();console.log(`simulating ${n}ms of latency from client to server`);let a={receives:[],receive(h,d){this.receives.push([h,d])}};return setTimeout(()=>{e.isDestroyed()||a.receives.reduce((h,[d,f])=>h.receive(d,f),i())},n),a}reloadWithJitter(e,t){e.destroy(),this.disconnect();let[i,n]=Kt,r=Math.floor(Math.random()*(n-i+1))+i,a=ne.updateLocal(this.localStorage,window.location.pathname,ot,0,h=>h+1);t?t():this.log(e,"join",()=>[`encountered ${a} consecutive reloads`]),a>at&&(this.log(e,"join",()=>[`exceeded ${at} consecutive reloads. Entering failsafe mode`]),r=qt),setTimeout(()=>{this.hasPendingLink()?window.location=this.pendingLink:window.location.reload()},r)}getHookCallbacks(e){return e&&e.startsWith("Phoenix.")?gi[e.split(".")[1]]:this.hooks[e]}isUnloaded(){return this.unloaded}isConnected(){return this.socket.isConnected()}getBindingPrefix(){return this.bindingPrefix}binding(e){return`${this.getBindingPrefix()}${e}`}channel(e,t){return this.socket.channel(e,t)}joinRootViews(){let e=!1;return p.all(document,`${de}:not([${ge}])`,t=>{if(!this.getRootById(t.id)){let i=this.newRootView(t);i.setHref(this.getHref()),i.join(),t.getAttribute(gt)&&(this.main=i)}e=!0}),e}redirect(e,t){this.disconnect(),ne.redirect(e,t)}replaceMain(e,t,i=null,n=this.setPendingLink(e)){let r=this.main.el,a=p.cloneNode(r,"");this.main.showLoader(this.loaderTimeout),this.main.destroy(),this.main=this.newRootView(a,t),this.main.setRedirect(e),this.main.join(h=>{h===1&&this.commitPendingLink(n)&&(r.replaceWith(a),i&&i())})}isPhxView(e){return e.getAttribute&&e.getAttribute(ie)!==null}newRootView(e,t){let i=new Ht(e,this,null,t);return this.roots[i.id]=i,i}owner(e,t){let i=z(e.closest(de),n=>this.getViewByEl(n));i&&t(i)}withinOwners(e,t){this.owner(e,i=>{let n=e.getAttribute(this.binding("target"));n===null?t(i,e):i.withinTargets(n,t)})}getViewByEl(e){let t=e.getAttribute(Pe);return z(this.getRootById(t),i=>i.getDescendentByEl(e))}getRootById(e){return this.roots[e]}destroyAllViews(){for(let e in this.roots)this.roots[e].destroy(),delete this.roots[e]}destroyViewByEl(e){let t=this.getRootById(e.getAttribute(Pe));t&&t.destroyDescendent(e.id)}setActiveElement(e){if(this.activeElement===e)return;this.activeElement=e;let t=()=>{e===this.activeElement&&(this.activeElement=null),e.removeEventListener("mouseup",this),e.removeEventListener("touchend",this)};e.addEventListener("mouseup",t),e.addEventListener("touchend",t)}getActiveElement(){return document.activeElement===document.body?this.activeElement||document.activeElement:document.activeElement||document.body}dropActiveElement(e){this.prevActive&&e.ownsElement(this.prevActive)&&(this.prevActive=null)}restorePreviouslyActiveFocus(){this.prevActive&&this.prevActive!==document.body&&this.prevActive.focus()}blurActiveElement(){this.prevActive=this.getActiveElement(),this.prevActive!==document.body&&this.prevActive.blur()}bindTopLevelEvents(){this.boundTopLevelEvents||(this.boundTopLevelEvents=!0,document.body.addEventListener("click",function(){}),window.addEventListener("pageshow",e=>{e.persisted&&(this.getSocket().disconnect(),this.withPageLoading({to:window.location.href,kind:"redirect"}),window.location.reload())},!0),this.bindNav(),this.bindClicks(),this.bindForms(),this.bind({keyup:"keyup",keydown:"keydown"},(e,t,i,n,r,a,h)=>{let d=n.getAttribute(this.binding(ii)),f=e.key&&e.key.toLowerCase();d&&d.toLowerCase()!==f||i.pushKey(n,r,t,a,Te({key:e.key},this.eventMeta(t,e,n)))}),this.bind({blur:"focusout",focus:"focusin"},(e,t,i,n,r,a,h)=>{h||i.pushEvent(t,n,r,a,this.eventMeta(t,e,n))}),this.bind({blur:"blur",focus:"focus"},(e,t,i,n,r,a,h)=>{h&&!h!=="window"&&i.pushEvent(t,n,r,a,this.eventMeta(t,e,n))}),window.addEventListener("dragover",e=>e.preventDefault()),window.addEventListener("drop",e=>{e.preventDefault();let t=z(ke(e.target,this.binding(ut)),r=>r.getAttribute(this.binding(ut))),i=t&&document.getElementById(t),n=Array.from(e.dataTransfer.files||[]);!i||i.disabled||n.length===0||!(i.files instanceof FileList)||(j.trackFiles(i,n),i.dispatchEvent(new Event("input",{bubbles:!0})))}),this.on(ht,e=>{let t=e.target;if(!p.isUploadInput(t))return;let i=Array.from(e.detail.files||[]).filter(n=>n instanceof File||n instanceof Blob);j.trackFiles(t,i),t.dispatchEvent(new Event("input",{bubbles:!0}))}))}eventMeta(e,t,i){let n=this.metadataCallbacks[e];return n?n(t,i):{}}setPendingLink(e){return this.linkRef++,this.pendingLink=e,this.linkRef}commitPendingLink(e){return this.linkRef!==e?!1:(this.href=this.pendingLink,this.pendingLink=null,!0)}getHref(){return this.href}hasPendingLink(){return!!this.pendingLink}bind(e,t){for(let i in e){let n=e[i];this.on(n,r=>{let a=this.binding(i),h=this.binding(`window-${i}`),d=r.target.getAttribute&&r.target.getAttribute(a);d?this.debounce(r.target,r,()=>{this.withinOwners(r.target,(f,E)=>{t(r,i,f,r.target,E,d,null)})}):p.all(document,`[${h}]`,f=>{let E=f.getAttribute(h);this.debounce(f,r,()=>{this.withinOwners(f,(g,T)=>{t(r,i,g,f,T,E,"window")})})})})}}bindClicks(){this.bindClick("click","click",!1),this.bindClick("mousedown","capture-click",!0)}bindClick(e,t,i){let n=this.binding(t);window.addEventListener(e,r=>{if(!this.isConnected())return;let a=null;i?a=r.target.matches(`[${n}]`)?r.target:r.target.querySelector(`[${n}]`):a=ke(r.target,n);let h=a&&a.getAttribute(n);!h||(a.getAttribute("href")==="#"&&r.preventDefault(),this.debounce(a,r,()=>{this.withinOwners(a,(d,f)=>{d.pushEvent("click",a,f,h,this.eventMeta("click",r,a))})}))},i)}bindNav(){if(!ne.canPushState())return;history.scrollRestoration&&(history.scrollRestoration="manual");let e=null;window.addEventListener("scroll",t=>{clearTimeout(e),e=setTimeout(()=>{ne.updateCurrentState(i=>Object.assign(i,{scroll:window.scrollY}))},100)}),window.addEventListener("popstate",t=>{if(!this.registerNewLocation(window.location))return;let{type:i,id:n,root:r,scroll:a}=t.state||{},h=window.location.href;this.main.isConnected()&&i==="patch"&&n===this.main.id?this.main.pushLinkPatch(h,null):this.replaceMain(h,null,()=>{r&&this.replaceRootHistory(),typeof a=="number"&&setTimeout(()=>{window.scrollTo(0,a)},0)})},!1),window.addEventListener("click",t=>{let i=ke(t.target,Fe),n=i&&i.getAttribute(Fe),r=t.metaKey||t.ctrlKey||t.button===1;if(!n||!this.isConnected()||!this.main||r)return;let a=i.href,h=i.getAttribute(zt);if(t.preventDefault(),this.pendingLink!==a)if(n==="patch")this.pushHistoryPatch(a,h,i);else if(n==="redirect")this.historyRedirect(a,h);else throw new Error(`expected ${Fe} to be "patch" or "redirect", got: ${n}`)},!1)}withPageLoading(e,t){p.dispatchEvent(window,"phx:page-loading-start",e);let i=()=>p.dispatchEvent(window,"phx:page-loading-stop",e);return t?t(i):i}pushHistoryPatch(e,t,i){this.withPageLoading({to:e,kind:"patch"},n=>{this.main.pushLinkPatch(e,i,r=>{this.historyPatch(e,t,r),n()})})}historyPatch(e,t,i=this.setPendingLink(e)){!this.commitPendingLink(i)||(ne.pushState(t,{type:"patch",id:this.main.id},e),this.registerNewLocation(window.location))}historyRedirect(e,t,i){let n=window.scrollY;this.withPageLoading({to:e,kind:"redirect"},r=>{this.replaceMain(e,i,()=>{ne.pushState(t,{type:"redirect",id:this.main.id,scroll:n},e),this.registerNewLocation(window.location),r()})})}replaceRootHistory(){ne.pushState("replace",{root:!0,type:"patch",id:this.main.id})}registerNewLocation(e){let{pathname:t,search:i}=this.currentLocation;return t+i===e.pathname+e.search?!1:(this.currentLocation=ye(e),!0)}bindForms(){let e=0;this.on("submit",t=>{let i=t.target.getAttribute(this.binding("submit"));!i||(t.preventDefault(),t.target.disabled=!0,this.withinOwners(t.target,(n,r)=>n.submitForm(t.target,r,i)))},!1);for(let t of["change","input"])this.on(t,i=>{let n=i.target,r=n.form&&n.form.getAttribute(this.binding("change"));if(!r||n.type==="number"&&n.validity&&n.validity.badInput)return;let a=e;e++;let{at:h,type:d}=p.private(n,"prev-iteration")||{};h===a-1&&t!==d||(p.putPrivate(n,"prev-iteration",{at:a,type:t}),this.debounce(n,i,()=>{this.withinOwners(n.form,(f,E)=>{p.putPrivate(n,bt,!0),p.isTextualInput(n)||this.setActiveElement(n),f.pushInput(n,E,null,r,i.target)})}))},!1)}debounce(e,t,i){let n=this.binding(ei),r=this.binding(ti),a=this.defaults.debounce.toString(),h=this.defaults.throttle.toString();p.debounce(e,t,n,a,r,h,i)}silenceEvents(e){this.silenced=!0,e(),this.silenced=!1}on(e,t){window.addEventListener(e,i=>{this.silenced||t(i)})}};var xi=document.querySelector("html").getAttribute("phx-socket")||"/live",Oi=document.querySelector("meta[name='csrf-token']").getAttribute("content"),Hi={},Ni=new Nt(xi,jt.Socket,{hooks:Hi,params:{_csrf_token:Oi}});Ni.connect();})();
